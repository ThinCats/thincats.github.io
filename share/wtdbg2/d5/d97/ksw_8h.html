<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>wtdbg: ksw.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">wtdbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d97/ksw_8h.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ksw.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ksw.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d7e/ksw_8h__incl.png" border="0" usemap="#ksw_8h" alt=""/></div>
<map name="ksw_8h" id="ksw_8h">
<area shape="rect"  title=" " alt="" coords="11,5,70,32"/>
<area shape="rect"  title=" " alt="" coords="5,80,76,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d4b/ksw_8h__dep__incl.png" border="0" usemap="#ksw_8hdep" alt=""/></div>
<map name="ksw_8hdep" id="ksw_8hdep">
<area shape="rect"  title=" " alt="" coords="161,5,220,32"/>
<area shape="rect"  href="../../d3/d39/dbgcns_8h.html" title=" " alt="" coords="5,80,85,107"/>
<area shape="rect"  href="../../d1/dd3/tripoa_8h.html" title=" " alt="" coords="203,80,275,107"/>
<area shape="rect"  href="../../d2/df4/kswx_8h.html" title=" " alt="" coords="110,80,178,107"/>
<area shape="rect"  href="../../d6/d1c/ksw_8c.html" title=" " alt="" coords="299,80,357,107"/>
<area shape="rect"  href="../../d3/d03/wtdbg-cns_8c.html" title=" " alt="" coords="37,155,137,181"/>
<area shape="rect"  href="../../db/d1f/wtpoa_8h.html" title=" " alt="" coords="180,155,255,181"/>
<area shape="rect"  href="../../d8/d2a/kbmpoa_8h.html" title=" " alt="" coords="115,229,202,256"/>
<area shape="rect"  href="../../d0/dcc/wtpoa-cns_8c.html" title=" " alt="" coords="226,229,326,256"/>
<area shape="rect"  href="../../d4/d4d/kbm_8c.html" title=" " alt="" coords="81,304,143,331"/>
<area shape="rect"  href="../../de/d6d/wtdbg_8h.html" title=" " alt="" coords="168,304,243,331"/>
<area shape="rect"  href="../../d4/d4d/wtdbg-graph_8h.html" title=" " alt="" coords="99,379,215,405"/>
<area shape="rect"  href="../../db/d54/wtdbg_8c.html" title=" " alt="" coords="169,453,242,480"/>
</map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d25/structkswr__t.html">kswr_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a388a8f0d345df67b79d92976a394ebab"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a388a8f0d345df67b79d92976a394ebab">KSW_XBYTE</a>&#160;&#160;&#160;0x10000</td></tr>
<tr class="separator:a388a8f0d345df67b79d92976a394ebab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e95112abfdfa3f0e7ba8b1a4934e24f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a3e95112abfdfa3f0e7ba8b1a4934e24f">KSW_XSTOP</a>&#160;&#160;&#160;0x20000</td></tr>
<tr class="separator:a3e95112abfdfa3f0e7ba8b1a4934e24f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6340ae00716e79b4d820303710f5a21"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#ad6340ae00716e79b4d820303710f5a21">KSW_XSUBO</a>&#160;&#160;&#160;0x40000</td></tr>
<tr class="separator:ad6340ae00716e79b4d820303710f5a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cbd7ce1bac8e3745b5fa1c4f2a25000"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a9cbd7ce1bac8e3745b5fa1c4f2a25000">KSW_XSTART</a>&#160;&#160;&#160;0x80000</td></tr>
<tr class="separator:a9cbd7ce1bac8e3745b5fa1c4f2a25000"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a9ff05689c463b0536ae63ffdc9d59a51"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../dd/dff/struct__kswq__t.html">_kswq_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a></td></tr>
<tr class="separator:a9ff05689c463b0536ae63ffdc9d59a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa77df9211e983ff979de29cba01a9263"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d25/structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#aa77df9211e983ff979de29cba01a9263">ksw_align</a> (int qlen, uint8_t *query, int tlen, uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int xtra, <a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **qry)</td></tr>
<tr class="separator:aa77df9211e983ff979de29cba01a9263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a01aa7df675160895b0a5100b6134c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d25/structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#ae6a01aa7df675160895b0a5100b6134c">ksw_align2</a> (int qlen, uint8_t *query, int tlen, uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int xtra, <a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **qry)</td></tr>
<tr class="separator:ae6a01aa7df675160895b0a5100b6134c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c1d07f3505122ace83bbfea572c085"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a99c1d07f3505122ace83bbfea572c085">ksw_global</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int w, int *n_cigar, uint32_t **cigar)</td></tr>
<tr class="separator:a99c1d07f3505122ace83bbfea572c085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157acb03d7153dd297ef746c5e0c6501"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a157acb03d7153dd297ef746c5e0c6501">ksw_global2</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int w, int *n_cigar, uint32_t **cigar)</td></tr>
<tr class="separator:a157acb03d7153dd297ef746c5e0c6501"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd8bb5a192234c25cae54feb3471ea5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a8bd8bb5a192234c25cae54feb3471ea5">ksw_extend</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int w, int end_bonus, int zdrop, int h0, int *qle, int *tle, int *gtle, int *gscore, int *max_off)</td></tr>
<tr class="separator:a8bd8bb5a192234c25cae54feb3471ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06e8727b015a1a9662c34b61f82276c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d97/ksw_8h.html#a06e8727b015a1a9662c34b61f82276c3">ksw_extend2</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int w, int end_bonus, int zdrop, int h0, int *qle, int *tle, int *gtle, int *gscore, int *max_off)</td></tr>
<tr class="separator:a06e8727b015a1a9662c34b61f82276c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a388a8f0d345df67b79d92976a394ebab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a388a8f0d345df67b79d92976a394ebab">&#9670;&nbsp;</a></span>KSW_XBYTE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSW_XBYTE&#160;&#160;&#160;0x10000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9cbd7ce1bac8e3745b5fa1c4f2a25000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cbd7ce1bac8e3745b5fa1c4f2a25000">&#9670;&nbsp;</a></span>KSW_XSTART</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSW_XSTART&#160;&#160;&#160;0x80000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3e95112abfdfa3f0e7ba8b1a4934e24f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e95112abfdfa3f0e7ba8b1a4934e24f">&#9670;&nbsp;</a></span>KSW_XSTOP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSW_XSTOP&#160;&#160;&#160;0x20000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6340ae00716e79b4d820303710f5a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6340ae00716e79b4d820303710f5a21">&#9670;&nbsp;</a></span>KSW_XSUBO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSW_XSUBO&#160;&#160;&#160;0x40000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a9ff05689c463b0536ae63ffdc9d59a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff05689c463b0536ae63ffdc9d59a51">&#9670;&nbsp;</a></span>kswq_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../dd/dff/struct__kswq__t.html">_kswq_t</a> <a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa77df9211e983ff979de29cba01a9263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa77df9211e983ff979de29cba01a9263">&#9670;&nbsp;</a></span>ksw_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d25/structkswr__t.html">kswr_t</a> ksw_align </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xtra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **&#160;</td>
          <td class="paramname"><em>qry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Aligning two sequences</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qlen</td><td>length of the query sequence (typically &lt;tlen) </td></tr>
    <tr><td class="paramname">query</td><td>query sequence with 0 &lt;= query[i] &lt; m </td></tr>
    <tr><td class="paramname">tlen</td><td>length of the target sequence </td></tr>
    <tr><td class="paramname">target</td><td>target sequence </td></tr>
    <tr><td class="paramname">m</td><td>number of residue types </td></tr>
    <tr><td class="paramname">mat</td><td>m*m scoring matrix in one-dimension array </td></tr>
    <tr><td class="paramname">gapo</td><td>gap open penalty; a gap of length l cost "-(gapo+l*gape)" </td></tr>
    <tr><td class="paramname">gape</td><td>gap extension penalty </td></tr>
    <tr><td class="paramname">xtra</td><td>extra information (see below) </td></tr>
    <tr><td class="paramname">qry</td><td>query profile (see below)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>alignment information in a struct; unset values to -1</dd></dl>
<p>When xtra==0, <a class="el" href="../../d5/d97/ksw_8h.html#aa77df9211e983ff979de29cba01a9263">ksw_align()</a> uses a signed two-byte integer to store a score and only finds the best score and the end positions. The 2nd best score or the start positions are not attempted. The default behavior can be tuned by setting KSW_X* flags:</p>
<p>KSW_XBYTE: use an unsigned byte to store a score. If overflow occurs, <a class="el" href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">kswr_t::score</a> will be set to 255</p>
<p>KSW_XSUBO: track the 2nd best score and the ending position on the target if the 2nd best is higher than (xtra&amp;0xffff)</p>
<p>KSW_XSTOP: stop if the maximum score is above (xtra&amp;0xffff)</p>
<p>KSW_XSTART: find the start positions</p>
<p>When *qry==NULL, <a class="el" href="../../d5/d97/ksw_8h.html#aa77df9211e983ff979de29cba01a9263">ksw_align()</a> will compute and allocate the query profile and when the function returns, *qry will point to the profile, which can be deallocated simply by free(). If one query is aligned against multiple target sequences, *qry should be set to NULL during the first call and freed after the last call. Note that qry can equal 0. In this case, the query profile will be deallocated in <a class="el" href="../../d5/d97/ksw_8h.html#aa77df9211e983ff979de29cba01a9263">ksw_align()</a>. </p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d1c/ksw_8c.html#ae6a01aa7df675160895b0a5100b6134c">ksw_align2</a>(qlen, query, tlen, target, m, mat, gapo, gape, gapo, gape, xtra, qry);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div><div class="ttc" id="ksw_8c_html_ae6a01aa7df675160895b0a5100b6134c"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#ae6a01aa7df675160895b0a5100b6134c">ksw_align2</a></div><div class="ttdeci">kswr_t ksw_align2(int qlen, uint8_t *query, int tlen, uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int xtra, kswq_t **qry)</div><div class="ttdef"><b>Definition:</b> ksw.c:344</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6a01aa7df675160895b0a5100b6134c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a01aa7df675160895b0a5100b6134c">&#9670;&nbsp;</a></span>ksw_align2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d25/structkswr__t.html">kswr_t</a> ksw_align2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xtra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d97/ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **&#160;</td>
          <td class="paramname"><em>qry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">int</span> size;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../dd/dff/struct__kswq__t.html">kswq_t</a> *q;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="../../de/d25/structkswr__t.html">kswr_t</a> r, rr;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="../../de/d25/structkswr__t.html">kswr_t</a> (*func)(<a class="code" href="../../dd/dff/struct__kswq__t.html">kswq_t</a>*, int, <span class="keyword">const</span> uint8_t*, int, int, int, int, int);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    q = (qry &amp;&amp; *qry)? *qry : <a class="code" href="../../d6/d1c/ksw_8c.html#a295f1f9c1e0144e81d4c5900a6698601">ksw_qinit</a>((xtra&amp;<a class="code" href="../../d5/d97/ksw_8h.html#a388a8f0d345df67b79d92976a394ebab">KSW_XBYTE</a>)? 1 : 2, qlen, query, m, mat);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (qry &amp;&amp; *qry == 0) *qry = q;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    func = q-&gt;<a class="code" href="../../dd/dff/struct__kswq__t.html#a7ba48bac78067bfea3285e0a868a685e">size</a> == 2? <a class="code" href="../../d6/d1c/ksw_8c.html#aa24677fdc656c726046b3166b8286bea">ksw_i16</a> : <a class="code" href="../../d6/d1c/ksw_8c.html#a09be34a2ff991aeb136cdc5c98719111">ksw_u8</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    size = q-&gt;<a class="code" href="../../dd/dff/struct__kswq__t.html#a7ba48bac78067bfea3285e0a868a685e">size</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    r = func(q, tlen, target, o_del, e_del, o_ins, e_ins, xtra);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (qry == 0) free(q);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> ((xtra&amp;<a class="code" href="../../d5/d97/ksw_8h.html#a9cbd7ce1bac8e3745b5fa1c4f2a25000">KSW_XSTART</a>) == 0 || ((xtra&amp;<a class="code" href="../../d5/d97/ksw_8h.html#ad6340ae00716e79b4d820303710f5a21">KSW_XSUBO</a>) &amp;&amp; r.<a class="code" href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">score</a> &lt; (xtra&amp;0xffff))) <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="../../d6/d1c/ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a>(r.<a class="code" href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">qe</a> + 1, query); <a class="code" href="../../d6/d1c/ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a>(r.<a class="code" href="../../de/d25/structkswr__t.html#aa69bf49cab94c1ece6a1cf76edb1ea9c">te</a> + 1, target); <span class="comment">// +1 because qe/te points to the exact end, not the position after the end</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    q = <a class="code" href="../../d6/d1c/ksw_8c.html#a295f1f9c1e0144e81d4c5900a6698601">ksw_qinit</a>(size, r.<a class="code" href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">qe</a> + 1, query, m, mat);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    rr = func(q, tlen, target, o_del, e_del, o_ins, e_ins, <a class="code" href="../../d5/d97/ksw_8h.html#a3e95112abfdfa3f0e7ba8b1a4934e24f">KSW_XSTOP</a> | r.<a class="code" href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">score</a>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="../../d6/d1c/ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a>(r.<a class="code" href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">qe</a> + 1, query); <a class="code" href="../../d6/d1c/ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a>(r.<a class="code" href="../../de/d25/structkswr__t.html#aa69bf49cab94c1ece6a1cf76edb1ea9c">te</a> + 1, target);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    free(q);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (r.<a class="code" href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">score</a> == rr.<a class="code" href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">score</a>)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        r.<a class="code" href="../../de/d25/structkswr__t.html#aa7ec982fe74fbb60b2cba04568c31295">tb</a> = r.<a class="code" href="../../de/d25/structkswr__t.html#aa69bf49cab94c1ece6a1cf76edb1ea9c">te</a> - rr.<a class="code" href="../../de/d25/structkswr__t.html#aa69bf49cab94c1ece6a1cf76edb1ea9c">te</a>, r.<a class="code" href="../../de/d25/structkswr__t.html#a726f86a2e3be73519fa46b2a44f64a5f">qb</a> = r.<a class="code" href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">qe</a> - rr.<a class="code" href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">qe</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">return</span> r;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="ttc" id="struct__kswq__t_html"><div class="ttname"><a href="../../dd/dff/struct__kswq__t.html">_kswq_t</a></div><div class="ttdef"><b>Definition:</b> ksw.c:45</div></div>
<div class="ttc" id="structkswr__t_html_aa7ec982fe74fbb60b2cba04568c31295"><div class="ttname"><a href="../../de/d25/structkswr__t.html#aa7ec982fe74fbb60b2cba04568c31295">kswr_t::tb</a></div><div class="ttdeci">int tb</div><div class="ttdef"><b>Definition:</b> ksw.h:18</div></div>
<div class="ttc" id="struct__kswq__t_html_a7ba48bac78067bfea3285e0a868a685e"><div class="ttname"><a href="../../dd/dff/struct__kswq__t.html#a7ba48bac78067bfea3285e0a868a685e">_kswq_t::size</a></div><div class="ttdeci">uint8_t size</div><div class="ttdef"><b>Definition:</b> ksw.c:47</div></div>
<div class="ttc" id="ksw_8h_html_a3e95112abfdfa3f0e7ba8b1a4934e24f"><div class="ttname"><a href="../../d5/d97/ksw_8h.html#a3e95112abfdfa3f0e7ba8b1a4934e24f">KSW_XSTOP</a></div><div class="ttdeci">#define KSW_XSTOP</div><div class="ttdef"><b>Definition:</b> ksw.h:7</div></div>
<div class="ttc" id="structkswr__t_html_a0a22a140652a9e40a417a2d54e070829"><div class="ttname"><a href="../../de/d25/structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">kswr_t::score</a></div><div class="ttdeci">int score</div><div class="ttdef"><b>Definition:</b> ksw.h:15</div></div>
<div class="ttc" id="ksw_8h_html_a9cbd7ce1bac8e3745b5fa1c4f2a25000"><div class="ttname"><a href="../../d5/d97/ksw_8h.html#a9cbd7ce1bac8e3745b5fa1c4f2a25000">KSW_XSTART</a></div><div class="ttdeci">#define KSW_XSTART</div><div class="ttdef"><b>Definition:</b> ksw.h:9</div></div>
<div class="ttc" id="ksw_8h_html_ad6340ae00716e79b4d820303710f5a21"><div class="ttname"><a href="../../d5/d97/ksw_8h.html#ad6340ae00716e79b4d820303710f5a21">KSW_XSUBO</a></div><div class="ttdeci">#define KSW_XSUBO</div><div class="ttdef"><b>Definition:</b> ksw.h:8</div></div>
<div class="ttc" id="structkswr__t_html_aa69bf49cab94c1ece6a1cf76edb1ea9c"><div class="ttname"><a href="../../de/d25/structkswr__t.html#aa69bf49cab94c1ece6a1cf76edb1ea9c">kswr_t::te</a></div><div class="ttdeci">int te</div><div class="ttdef"><b>Definition:</b> ksw.h:16</div></div>
<div class="ttc" id="ksw_8c_html_a09be34a2ff991aeb136cdc5c98719111"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#a09be34a2ff991aeb136cdc5c98719111">ksw_u8</a></div><div class="ttdeci">kswr_t ksw_u8(kswq_t *q, int tlen, const uint8_t *target, int _o_del, int _e_del, int _o_ins, int _e_ins, int xtra)</div><div class="ttdef"><b>Definition:</b> ksw.c:110</div></div>
<div class="ttc" id="structkswr__t_html"><div class="ttname"><a href="../../de/d25/structkswr__t.html">kswr_t</a></div><div class="ttdef"><b>Definition:</b> ksw.h:14</div></div>
<div class="ttc" id="structkswr__t_html_a5de5440fa8fd951df5483edf55f7cddd"><div class="ttname"><a href="../../de/d25/structkswr__t.html#a5de5440fa8fd951df5483edf55f7cddd">kswr_t::qe</a></div><div class="ttdeci">int qe</div><div class="ttdef"><b>Definition:</b> ksw.h:16</div></div>
<div class="ttc" id="ksw_8c_html_a9b86b0e1cab2423ed292be074a3c5c27"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a></div><div class="ttdeci">static void revseq(int l, uint8_t *s)</div><div class="ttdef"><b>Definition:</b> ksw.c:337</div></div>
<div class="ttc" id="structkswr__t_html_a726f86a2e3be73519fa46b2a44f64a5f"><div class="ttname"><a href="../../de/d25/structkswr__t.html#a726f86a2e3be73519fa46b2a44f64a5f">kswr_t::qb</a></div><div class="ttdeci">int qb</div><div class="ttdef"><b>Definition:</b> ksw.h:18</div></div>
<div class="ttc" id="ksw_8h_html_a388a8f0d345df67b79d92976a394ebab"><div class="ttname"><a href="../../d5/d97/ksw_8h.html#a388a8f0d345df67b79d92976a394ebab">KSW_XBYTE</a></div><div class="ttdeci">#define KSW_XBYTE</div><div class="ttdef"><b>Definition:</b> ksw.h:6</div></div>
<div class="ttc" id="ksw_8c_html_a295f1f9c1e0144e81d4c5900a6698601"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#a295f1f9c1e0144e81d4c5900a6698601">ksw_qinit</a></div><div class="ttdeci">kswq_t * ksw_qinit(int size, int qlen, const uint8_t *query, int m, const int8_t *mat)</div><div class="ttdef"><b>Definition:</b> ksw.c:62</div></div>
<div class="ttc" id="ksw_8c_html_aa24677fdc656c726046b3166b8286bea"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#aa24677fdc656c726046b3166b8286bea">ksw_i16</a></div><div class="ttdeci">kswr_t ksw_i16(kswq_t *q, int tlen, const uint8_t *target, int _o_del, int _e_del, int _o_ins, int _e_ins, int xtra)</div><div class="ttdef"><b>Definition:</b> ksw.c:233</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bd8bb5a192234c25cae54feb3471ea5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd8bb5a192234c25cae54feb3471ea5">&#9670;&nbsp;</a></span>ksw_extend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_extend </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end_bonus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zdrop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gtle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gscore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>max_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Extend alignment</p>
<p>The routine aligns $query and $target, assuming their upstream sequences, which are not provided, have been aligned with score $h0. In return, region [0,*qle) on the query and [0,*tle) on the target sequences are aligned together. If *gscore&gt;=0, *gscore keeps the best score such that the entire query sequence is aligned; *gtle keeps the position on the target where *gscore is achieved. Returning *gscore and *gtle helps the caller to decide whether an end-to-end hit or a partial hit is preferred.</p>
<p>The first 9 parameters are identical to those in <a class="el" href="../../d5/d97/ksw_8h.html#a99c1d07f3505122ace83bbfea572c085">ksw_global()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h0</td><td>alignment score of upstream sequences </td></tr>
    <tr><td class="paramname">_qle</td><td>(out) length of the query in the alignment </td></tr>
    <tr><td class="paramname">_tle</td><td>(out) length of the target in the alignment </td></tr>
    <tr><td class="paramname">_gtle</td><td>(out) length of the target if query is fully aligned </td></tr>
    <tr><td class="paramname">_gscore</td><td>(out) score of the best end-to-end alignment; negative if not found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>best semi-local alignment score </dd></dl>
<div class="fragment"><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;{</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d1c/ksw_8c.html#af5d54be11b210ddd9dae4be394350a59">ksw_extend2</a>(qlen, query, tlen, target, m, mat, gapo, gape, gapo, gape, w, end_bonus, zdrop, h0, qle, tle, gtle, gscore, max_off);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="ttc" id="ksw_8c_html_af5d54be11b210ddd9dae4be394350a59"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#af5d54be11b210ddd9dae4be394350a59">ksw_extend2</a></div><div class="ttdeci">int ksw_extend2(int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int w, int end_bonus, int zdrop, int h0, int *_qle, int *_tle, int *_gtle, int *_gscore, int *_max_off)</div><div class="ttdef"><b>Definition:</b> ksw.c:381</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06e8727b015a1a9662c34b61f82276c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06e8727b015a1a9662c34b61f82276c3">&#9670;&nbsp;</a></span>ksw_extend2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_extend2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>end_bonus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zdrop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gtle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gscore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>max_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="../../d5/d2d/structeh__t.html">eh_t</a> *eh; <span class="comment">// score array</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    int8_t *qp; <span class="comment">// query profile</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">int</span> i, j, k, oe_del = o_del + e_del, oe_ins = o_ins + e_ins, beg, end, max, max_i, max_j, max_ins, max_del, max_ie, gscore, max_off;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (h0 &lt; 0) h0 = 0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// allocate memory</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    qp = malloc(qlen * m);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    eh = calloc(qlen + 1, 8);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// generate the query profile</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">for</span> (k = i = 0; k &lt; m; ++k) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keyword">const</span> int8_t *p = &amp;mat[k * m];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; qlen; ++j) qp[i++] = p[query[j]];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// fill the first row</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    eh[0].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h0; eh[1].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h0 &gt; oe_ins? h0 - oe_ins : 0;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span> (j = 2; j &lt;= qlen &amp;&amp; eh[j-1].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> &gt; e_ins; ++j)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        eh[j].h = eh[j-1].h - e_ins;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// adjust $w if it is too large</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    k = m * m;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (i = 0, max = 0; i &lt; k; ++i) <span class="comment">// get the max score</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        max = max &gt; mat[i]? max : mat[i];</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    max_ins = (int)((<span class="keywordtype">double</span>)(qlen * max + end_bonus - o_ins) / e_ins + 1.);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    max_ins = max_ins &gt; 1? max_ins : 1;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    w = w &lt; max_ins? w : max_ins;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    max_del = (int)((<span class="keywordtype">double</span>)(qlen * max + end_bonus - o_del) / e_del + 1.);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    max_del = max_del &gt; 1? max_del : 1;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    w = w &lt; max_del? w : max_del; <span class="comment">// TODO: is this necessary?</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// DP loop</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    max = h0, max_i = max_j = -1; max_ie = -1, gscore = -1;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    max_off = 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    beg = 0, end = qlen;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(i &lt; tlen); ++i) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordtype">int</span> t, f = 0, h1, m = 0, mj = -1;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        int8_t *q = &amp;qp[target[i] * qlen];</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">// compute the first column</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        h1 = h0 - (o_del + e_del * (i + 1));</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (h1 &lt; 0) h1 = 0;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// apply the band and the constraint (if provided)</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> (beg &lt; i - w) beg = i - w;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">if</span> (end &gt; i + w + 1) end = i + w + 1;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> (end &gt; qlen) end = qlen;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keywordflow">for</span> (j = beg; <a class="code" href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(j &lt; end); ++j) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="comment">// At the beginning of the loop: eh[j] = { H(i-1,j-1), E(i,j) }, f = F(i,j) and h1 = H(i,j-1)</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="comment">// Similar to SSE2-SW, cells are computed in the following order:</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">//   H(i,j)   = max{H(i-1,j-1)+S(i,j), E(i,j), F(i,j)}</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="comment">//   E(i+1,j) = max{H(i,j)-gapo, E(i,j)} - gape</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="comment">//   F(i,j+1) = max{H(i,j)-gapo, F(i,j)} - gape</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <a class="code" href="../../d5/d2d/structeh__t.html">eh_t</a> *p = &amp;eh[j];</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordtype">int</span> h, M = p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a>, e = p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a>; <span class="comment">// get H(i-1,j-1) and E(i-1,j)</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h1;          <span class="comment">// set H(i,j-1) for the next row</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            M += q[j];          <span class="comment">// separating H and M to disallow a cigar like &quot;100M3I3D20M&quot;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            h = M &gt; e? M : e;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            h = h &gt; f? h : f;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            h1 = h;             <span class="comment">// save H(i,j) to h1 for the next column</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            mj = m &gt; h? mj : j; <span class="comment">// record the position where max score is achieved</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            m = m &gt; h? m : h;   <span class="comment">// m is stored at eh[mj+1]</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            t = M - oe_del;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            t = t &gt; 0? t : 0;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            e -= e_del;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            e = e &gt; t? e : t;   <span class="comment">// computed E(i+1,j)</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = e;           <span class="comment">// save E(i+1,j) for the next row</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            t = M - oe_ins;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            t = t &gt; 0? t : 0;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            f -= e_ins;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            f = f &gt; t? f : t;   <span class="comment">// computed F(i,j+1)</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        eh[end].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h1; eh[end].<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = 0;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (j == qlen) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            max_ie = gscore &gt; h1? max_ie : i;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            gscore = gscore &gt; h1? gscore : h1;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (m == 0) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (m &gt; max) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            max = m, max_i = i, max_j = mj;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            max_off = max_off &gt; abs(mj - i)? max_off : abs(mj - i);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (zdrop &gt; 0) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span> (i - max_i &gt; mj - max_j) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">if</span> (max - m - ((i - max_i) - (mj - max_j)) * e_del &gt; zdrop) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="keywordflow">if</span> (max - m - ((mj - max_j) - (i - max_i)) * e_ins &gt; zdrop) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">// update beg and end for the next round</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">for</span> (j = mj; j &gt;= beg &amp;&amp; eh[j].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a>; --j);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        beg = j + 1;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">for</span> (j = mj + 2; j &lt;= end &amp;&amp; eh[j].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a>; ++j);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        end = j;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">//beg = 0; end = qlen; // uncomment this line for debugging</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    free(eh); free(qp);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">if</span> (_qle) *_qle = max_j + 1;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> (_tle) *_tle = max_i + 1;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (_gtle) *_gtle = max_ie + 1;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span> (_gscore) *_gscore = gscore;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (_max_off) *_max_off = max_off;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> max;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div><div class="ttc" id="structeh__t_html_a61ba384a1fe5b964445a79380b898612"><div class="ttname"><a href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">eh_t::h</a></div><div class="ttdeci">int32_t h</div><div class="ttdef"><b>Definition:</b> ksw.c:378</div></div>
<div class="ttc" id="structeh__t_html"><div class="ttname"><a href="../../d5/d2d/structeh__t.html">eh_t</a></div><div class="ttdef"><b>Definition:</b> ksw.c:377</div></div>
<div class="ttc" id="ksw_8c_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition:</b> ksw.c:39</div></div>
<div class="ttc" id="structeh__t_html_a3bb218f7528b88ccf8fc1bf56ac5064b"><div class="ttname"><a href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">eh_t::e</a></div><div class="ttdeci">int32_t e</div><div class="ttdef"><b>Definition:</b> ksw.c:378</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99c1d07f3505122ace83bbfea572c085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c1d07f3505122ace83bbfea572c085">&#9670;&nbsp;</a></span>ksw_global()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_global </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n_cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t **&#160;</td>
          <td class="paramname"><em>cigar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Banded global alignment</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qlen</td><td>query length </td></tr>
    <tr><td class="paramname">query</td><td>query sequence with 0 &lt;= query[i] &lt; m </td></tr>
    <tr><td class="paramname">tlen</td><td>target length </td></tr>
    <tr><td class="paramname">target</td><td>target sequence with 0 &lt;= target[i] &lt; m </td></tr>
    <tr><td class="paramname">m</td><td>number of residue types </td></tr>
    <tr><td class="paramname">mat</td><td>m*m scoring mattrix in one-dimension array </td></tr>
    <tr><td class="paramname">gapo</td><td>gap open penalty; a gap of length l cost "-(gapo+l*gape)" </td></tr>
    <tr><td class="paramname">gape</td><td>gap extension penalty </td></tr>
    <tr><td class="paramname">w</td><td>band width </td></tr>
    <tr><td class="paramname">n_cigar</td><td>(out) number of CIGAR elements </td></tr>
    <tr><td class="paramname">cigar</td><td>(out) BAM-encoded CIGAR; caller need to deallocate with free()</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>score of the alignment </dd></dl>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d6/d1c/ksw_8c.html#ab3429600af32881906c7327a78e4e284">ksw_global2</a>(qlen, query, tlen, target, m, mat, gapo, gape, gapo, gape, w, n_cigar_, cigar_);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div><div class="ttc" id="ksw_8c_html_ab3429600af32881906c7327a78e4e284"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#ab3429600af32881906c7327a78e4e284">ksw_global2</a></div><div class="ttdeci">int ksw_global2(int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int o_del, int e_del, int o_ins, int e_ins, int w, int *n_cigar_, uint32_t **cigar_)</div><div class="ttdef"><b>Definition:</b> ksw.c:503</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a157acb03d7153dd297ef746c5e0c6501"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a157acb03d7153dd297ef746c5e0c6501">&#9670;&nbsp;</a></span>ksw_global2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_global2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>o_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_ins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n_cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t **&#160;</td>
          <td class="paramname"><em>cigar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;{</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="../../d5/d2d/structeh__t.html">eh_t</a> *eh;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    int8_t *qp; <span class="comment">// query profile</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">int</span> i, j, k, oe_del = o_del + e_del, oe_ins = o_ins + e_ins, score, n_col;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    uint8_t *z; <span class="comment">// backtrack matrix; in each cell: f&lt;&lt;4|e&lt;&lt;2|h; in principle, we can halve the memory, but backtrack will be a little more complex</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (n_cigar_) *n_cigar_ = 0;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// allocate memory</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    n_col = qlen &lt; 2*w+1? qlen : 2*w+1; <span class="comment">// maximum #columns of the backtrack matrix</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    z = malloc(n_col * tlen);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    qp = malloc(qlen * m);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    eh = calloc(qlen + 1, 8);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// generate the query profile</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">for</span> (k = i = 0; k &lt; m; ++k) {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keyword">const</span> int8_t *p = &amp;mat[k * m];</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; qlen; ++j) qp[i++] = p[query[j]];</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">// fill the first row</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    eh[0].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = 0; eh[0].<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">for</span> (j = 1; j &lt;= qlen &amp;&amp; j &lt;= w; ++j)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        eh[j].h = -(o_ins + e_ins * j), eh[j].<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">for</span> (; j &lt;= qlen; ++j) eh[j].h = eh[j].e = <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>; <span class="comment">// everything is -inf outside the band</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// DP loop</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">for</span> (i = 0; <a class="code" href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(i &lt; tlen); ++i) { <span class="comment">// target sequence is in the outer loop</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        int32_t f = <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>, h1, beg, end, t;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        int8_t *q = &amp;qp[target[i] * qlen];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        uint8_t *zi = &amp;z[i * n_col];</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        beg = i &gt; w? i - w : 0;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        end = i + w + 1 &lt; qlen? i + w + 1 : qlen; <span class="comment">// only loop through [beg,end) of the query sequence</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        h1 = beg == 0? -(o_del + e_del * (i + 1)) : <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">for</span> (j = beg; <a class="code" href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(j &lt; end); ++j) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="comment">// At the beginning of the loop: eh[j] = { H(i-1,j-1), E(i,j) }, f = F(i,j) and h1 = H(i,j-1)</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="comment">// Cells are computed in the following order:</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="comment">//   M(i,j)   = H(i-1,j-1) + S(i,j)</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="comment">//   H(i,j)   = max{M(i,j), E(i,j), F(i,j)}</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="comment">//   E(i+1,j) = max{M(i,j)-gapo, E(i,j)} - gape</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">//   F(i,j+1) = max{M(i,j)-gapo, F(i,j)} - gape</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="comment">// We have to separate M(i,j); otherwise the direction may not be recorded correctly.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">// However, a CIGAR like &quot;10M3I3D10M&quot; allowed by local() is disallowed by global().</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment">// Such a CIGAR may occur, in theory, if mismatch_penalty &gt; 2*gap_ext_penalty + 2*gap_open_penalty/k.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">// In practice, this should happen very rarely given a reasonable scoring system.</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="../../d5/d2d/structeh__t.html">eh_t</a> *p = &amp;eh[j];</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            int32_t h, m = p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a>, e = p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            uint8_t d; <span class="comment">// direction</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            m += q[j];</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            d = m &gt;= e? 0 : 1;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            h = m &gt;= e? m : e;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            d = h &gt;= f? d : 2;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            h = h &gt;= f? h : f;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            h1 = h;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            t = m - oe_del;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            e -= e_del;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            d |= e &gt; t? 1&lt;&lt;2 : 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            e  = e &gt; t? e    : t;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            p-&gt;<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = e;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            t = m - oe_ins;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            f -= e_ins;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            d |= f &gt; t? 2&lt;&lt;4 : 0; <span class="comment">// if we want to halve the memory, use one bit only, instead of two</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            f  = f &gt; t? f    : t;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            zi[j - beg] = d; <span class="comment">// z[i,j] keeps h for the current cell and e/f for the next cell</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        eh[end].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a> = h1; eh[end].<a class="code" href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">e</a> = <a class="code" href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    score = eh[qlen].<a class="code" href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">h</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (n_cigar_ &amp;&amp; cigar_) { <span class="comment">// backtrack</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordtype">int</span> n_cigar = 0, m_cigar = 0, which = 0;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        uint32_t *cigar = 0, tmp;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        i = tlen - 1; k = (i + w + 1 &lt; qlen? i + w + 1 : qlen) - 1; <span class="comment">// (i,k) points to the last cell</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">while</span> (i &gt;= 0 &amp;&amp; k &gt;= 0) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            which = z[i * n_col + (k - (i &gt; w? i - w : 0))] &gt;&gt; (which&lt;&lt;1) &amp; 3;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">if</span> (which == 0)      cigar = <a class="code" href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a>(&amp;n_cigar, &amp;m_cigar, cigar, 0, 1), --i, --k;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (which == 1) cigar = <a class="code" href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a>(&amp;n_cigar, &amp;m_cigar, cigar, 2, 1), --i;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">else</span>                 cigar = <a class="code" href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a>(&amp;n_cigar, &amp;m_cigar, cigar, 1, 1), --k;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span> (i &gt;= 0) cigar = <a class="code" href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a>(&amp;n_cigar, &amp;m_cigar, cigar, 2, i + 1);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (k &gt;= 0) cigar = <a class="code" href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a>(&amp;n_cigar, &amp;m_cigar, cigar, 1, k + 1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n_cigar&gt;&gt;1; ++i) <span class="comment">// reverse CIGAR</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            tmp = cigar[i], cigar[i] = cigar[n_cigar-1-i], cigar[n_cigar-1-i] = tmp;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        *n_cigar_ = n_cigar, *cigar_ = cigar;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    free(eh); free(qp); free(z);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">return</span> score;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div><div class="ttc" id="structeh__t_html_a61ba384a1fe5b964445a79380b898612"><div class="ttname"><a href="../../d5/d2d/structeh__t.html#a61ba384a1fe5b964445a79380b898612">eh_t::h</a></div><div class="ttdeci">int32_t h</div><div class="ttdef"><b>Definition:</b> ksw.c:378</div></div>
<div class="ttc" id="ksw_8c_html_a826957eb948116d000d8514b3cd85202"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a></div><div class="ttdeci">static uint32_t * push_cigar(int *n_cigar, int *m_cigar, uint32_t *cigar, int op, int len)</div><div class="ttdef"><b>Definition:</b> ksw.c:491</div></div>
<div class="ttc" id="structeh__t_html"><div class="ttname"><a href="../../d5/d2d/structeh__t.html">eh_t</a></div><div class="ttdef"><b>Definition:</b> ksw.c:377</div></div>
<div class="ttc" id="ksw_8c_html_affde14445f49f65ff4f5b592e44ee71a"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a></div><div class="ttdeci">#define LIKELY(x)</div><div class="ttdef"><b>Definition:</b> ksw.c:39</div></div>
<div class="ttc" id="ksw_8c_html_aa48b28e62c168ecef26792b023bedb09"><div class="ttname"><a href="../../d6/d1c/ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a></div><div class="ttdeci">#define MINUS_INF</div><div class="ttdef"><b>Definition:</b> ksw.c:489</div></div>
<div class="ttc" id="structeh__t_html_a3bb218f7528b88ccf8fc1bf56ac5064b"><div class="ttname"><a href="../../d5/d2d/structeh__t.html#a3bb218f7528b88ccf8fc1bf56ac5064b">eh_t::e</a></div><div class="ttdeci">int32_t e</div><div class="ttdef"><b>Definition:</b> ksw.c:378</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/d97/ksw_8h.html">ksw.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
