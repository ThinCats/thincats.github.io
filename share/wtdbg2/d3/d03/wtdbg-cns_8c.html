<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>wtdbg: wtdbg-cns.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">wtdbg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d3/d03/wtdbg-cns_8c.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">wtdbg-cns.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../">kswx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">dbgcns.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">dagcns.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">filereader.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wtdbg-cns.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/da7/wtdbg-cns_8c__incl.png" border="0" usemap="#wtdbg-cns_8c" alt=""/></div>
<map name="wtdbg-cns_8c" id="wtdbg-cns_8c">
<area shape="rect"  title=" " alt="" coords="856,5,956,32"/>
<area shape="rect"  href="../../d2/df4/kswx_8h.html" title=" " alt="" coords="687,80,755,107"/>
<area shape="rect"  href="../../d3/d39/dbgcns_8h.html" title=" " alt="" coords="918,80,998,107"/>
<area shape="rect"  href="../../d0/d48/dagcns_8h.html" title=" " alt="" coords="814,80,894,107"/>
<area shape="rect"  href="../../de/dc8/filereader_8h.html" title=" " alt="" coords="1717,155,1812,181"/>
<area shape="rect"  href="../../d5/d97/ksw_8h.html" title=" " alt="" coords="507,155,566,181"/>
<area shape="rect"  href="../../d0/df5/dna_8h.html" title=" " alt="" coords="691,155,750,181"/>
<area shape="rect"  href="../../da/d23/list_8h.html" title=" " alt="" coords="1115,304,1169,331"/>
<area shape="rect"  title=" " alt="" coords="5,304,73,331"/>
<area shape="rect"  href="../../d0/d2a/chararray_8h.html" title=" " alt="" coords="1231,229,1325,256"/>
<area shape="rect"  title=" " alt="" coords="48,155,111,181"/>
<area shape="rect"  title=" " alt="" coords="279,453,349,480"/>
<area shape="rect"  title=" " alt="" coords="761,528,832,555"/>
<area shape="rect"  title=" " alt="" coords="617,453,688,480"/>
<area shape="rect"  title=" " alt="" coords="763,453,830,480"/>
<area shape="rect"  href="../../db/dd5/thread_8h.html" title=" " alt="" coords="2412,453,2488,480"/>
<area shape="rect"  href="../../d5/d34/bitvec_8h.html" title=" " alt="" coords="503,304,578,331"/>
<area shape="rect"  href="../../d1/dcf/hashset_8h.html" title=" " alt="" coords="442,229,527,256"/>
<area shape="rect"  href="../../d7/d50/sort_8h.html" title=" " alt="" coords="1061,379,1119,405"/>
<area shape="rect"  href="../../d5/d11/mem__share_8h.html" title=" " alt="" coords="1400,379,1511,405"/>
<area shape="rect"  title=" " alt="" coords="956,453,1035,480"/>
<area shape="rect"  title=" " alt="" coords="2009,453,2094,480"/>
<area shape="rect"  title=" " alt="" coords="1059,453,1161,480"/>
<area shape="rect"  title=" " alt="" coords="1186,453,1277,480"/>
<area shape="rect"  title=" " alt="" coords="1301,453,1399,480"/>
<area shape="rect"  title=" " alt="" coords="2118,453,2193,480"/>
<area shape="rect"  title=" " alt="" coords="1424,453,1487,480"/>
<area shape="rect"  title=" " alt="" coords="2268,453,2336,480"/>
<area shape="rect"  title=" " alt="" coords="1511,453,1584,480"/>
<area shape="rect"  title=" " alt="" coords="1609,453,1683,480"/>
<area shape="rect"  title=" " alt="" coords="1708,453,1781,480"/>
<area shape="rect"  title=" " alt="" coords="1806,453,1897,480"/>
<area shape="rect"  title=" " alt="" coords="1921,453,1985,480"/>
<area shape="rect"  title=" " alt="" coords="2460,528,2544,555"/>
<area shape="rect"  title=" " alt="" coords="2361,528,2435,555"/>
<area shape="rect"  title=" " alt="" coords="1295,304,1370,331"/>
<area shape="rect"  href="../../d8/d38/queue_8h.html" title=" " alt="" coords="827,229,902,256"/>
<area shape="rect"  href="../../d4/deb/general__graph_8h.html" title=" " alt="" coords="825,155,952,181"/>
<area shape="rect"  title=" " alt="" coords="2257,229,2353,256"/>
<area shape="rect"  href="../../d0/df1/pgzf_8h.html" title=" " alt="" coords="1734,229,1795,256"/>
<area shape="rect"  title=" " alt="" coords="1957,304,2015,331"/>
</map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/structmcns__struct.html">mcns_struct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab5bf04e3e0d37f0501376b7da51d1c88"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#ab5bf04e3e0d37f0501376b7da51d1c88">MCNS_TASK_DBGCNS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ab5bf04e3e0d37f0501376b7da51d1c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1523b96cc68bc9d33539aa387954b4ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#a1523b96cc68bc9d33539aa387954b4ad">MCNS_TASK_DAGCNS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1523b96cc68bc9d33539aa387954b4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2482354f5176a12970941152bef9bf54"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a2482354f5176a12970941152bef9bf54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aecc81f50869379760e5611c76b20a877"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#aecc81f50869379760e5611c76b20a877">thread_mcns_func</a> (void *obj)</td></tr>
<tr class="separator:aecc81f50869379760e5611c76b20a877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3009bdcad257eddc048095708cfaa4d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#a3009bdcad257eddc048095708cfaa4d0">revise_joint_point</a> (<a class="el" href="../../de/d23/structu32list.html">u32list</a> *cigars, int *qe, int *te)</td></tr>
<tr class="separator:a3009bdcad257eddc048095708cfaa4d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95523c16ce0cffc8057aa897a81b828b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#a95523c16ce0cffc8057aa897a81b828b">revise_joint_point2</a> (<a class="el" href="../../de/d23/structu32list.html">u32list</a> *cigars, int *qe, int *te, int overhang)</td></tr>
<tr class="separator:a95523c16ce0cffc8057aa897a81b828b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab116f676e5cd5bbcba381f9eda24c652"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#ab116f676e5cd5bbcba381f9eda24c652">run</a> (int reglen, int ksize, int Z, int W, int M, int X, int I, int D, int E, int H, int L, int XX, int OO, int EE, int cns_model, <a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a> pM, <a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a> pX, <a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a> pI, <a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a> pD, int candidate_mode, int corr_struct, uint32_t ncpu, <a class="el" href="../../d0/d01/struct_file_reader.html">FileReader</a> *fr, FILE *out)</td></tr>
<tr class="separator:ab116f676e5cd5bbcba381f9eda24c652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad876cdd1a72412cf2e0d2fcde266dd9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a> ()</td></tr>
<tr class="separator:ad876cdd1a72412cf2e0d2fcde266dd9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af93b0552c2b23f6fd2b5d2c0ccb5ff10"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a> = 0</td></tr>
<tr class="separator:af93b0552c2b23f6fd2b5d2c0ccb5ff10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1523b96cc68bc9d33539aa387954b4ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1523b96cc68bc9d33539aa387954b4ad">&#9670;&nbsp;</a></span>MCNS_TASK_DAGCNS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MCNS_TASK_DAGCNS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab5bf04e3e0d37f0501376b7da51d1c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5bf04e3e0d37f0501376b7da51d1c88">&#9670;&nbsp;</a></span>MCNS_TASK_DBGCNS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MCNS_TASK_DBGCNS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2482354f5176a12970941152bef9bf54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2482354f5176a12970941152bef9bf54">&#9670;&nbsp;</a></span>MCNS_TASK_OVERLAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MCNS_TASK_OVERLAP&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                               {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="../../d0/d01/struct_file_reader.html">FileReader</a> *fr;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="../../d5/da7/structcplist.html">cplist</a> *infs;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    FILE *out;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">char</span> *outf;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">int</span> c, ncpu, overwrite, reglen, ksize, Z, W, C, M, X, I, D, E, H, L, XX, OO, EE;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span> candidate_mode, cns_model, corr_struct;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a> pM, pX, pI, pD;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    ncpu = 1;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    reglen = 1000;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    ksize = 15;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    Z = 4;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    W = 48;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    C = 1;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    M = 2;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    X = -7;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    I = -3;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    D = -4;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    E = -2;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    H = 1;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    L = 10;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    XX = -4;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    OO = -2;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    EE = -1;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    candidate_mode = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    cns_model = 1;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    corr_struct = 1;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    pM = log(0.85);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    pX = log(0.10);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    pI = log(0.03);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    pD = log(0.02);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    infs = <a class="code" href="../../da/d23/list_8h.html#a15e626a09f6e8a6ecacedb8a8b18c5f1">init_cplist</a>(4);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    outf = <a class="code" href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    overwrite = 0;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">while</span>((c = getopt(argc, argv, <span class="stringliteral">&quot;hvVt:k:i:o:fj:Z:W:C:M:X:I:D:E:H:L:m:c:S:&quot;</span>)) != -1){</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">switch</span>(c){</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>: <span class="keywordflow">return</span> <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a>();</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>: ncpu = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>: ksize = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>: <a class="code" href="../../da/d23/list_8h.html#a8b81c5bd445e9e9094799235e991d382">push_cplist</a>(infs, optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>: outf = optarg; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>: overwrite = 1; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>: reglen = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: Z = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>: W = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: C = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: M = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;X&#39;</span>: X = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>: I = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: D = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>: E = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: H = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: L = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>: cns_model = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: candidate_mode = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: corr_struct = atoi(optarg); <span class="keywordflow">break</span>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>: <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a> ++; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: fprintf(stdout, <span class="stringliteral">&quot;wtdbg-cns 1.1\n&quot;</span>); <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a>();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="../../d5/d11/mem__share_8h.html#a1b45fe9ee78cf91c830b4cee25182b44">BEG_STAT_PROC_INFO</a>(stderr, argc, argv);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span>(cns_model != <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ab5bf04e3e0d37f0501376b7da51d1c88">MCNS_TASK_DBGCNS</a> &amp;&amp; cns_model != <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a1523b96cc68bc9d33539aa387954b4ad">MCNS_TASK_DAGCNS</a>){</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a>();</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span>(ncpu &lt;= 0 &amp;&amp; <a class="code" href="../../d5/d11/mem__share_8h.html#a7ff6daf3b936c1306fb6e71573f0d7aa">_sig_proc_deamon</a>) ncpu = <a class="code" href="../../d5/d11/mem__share_8h.html#a7ff6daf3b936c1306fb6e71573f0d7aa">_sig_proc_deamon</a>-&gt;<a class="code" href="../../df/d18/struct__proc__deamon__struct.html#a20db1d7c8ffe40a71fa8d3de19b353ac">ncpu</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span>(ncpu &lt;= 0){</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot; -- Invalid cpu number &#39;%d&#39; in %s -- %s:%d --\n&quot;</span>, ncpu, __FUNCTION__, __FILE__, __LINE__); fflush(stderr);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span>(outf &amp;&amp; !overwrite &amp;&amp; file_exists(outf)){</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;File exists! &#39;%s&#39;\n\n&quot;</span>, outf);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a>();</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a> &gt; 1) <a class="code" href="../../d3/d39/dbgcns_8h.html#ac55238ccab99c929dd5e7f52ade8031c">DBGCNS_DEBUG</a> = 1;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span>(infs-&gt;<a class="code" href="../../d5/da7/structcplist.html#a43eaff655ac08b43e10a66b4a408cc03">size</a>) fr = <a class="code" href="../../de/dc8/filereader_8h.html#a02b5bd62773b99de59fa0bf8d7b13016">open_all_filereader</a>(infs-&gt;<a class="code" href="../../d5/da7/structcplist.html#a43eaff655ac08b43e10a66b4a408cc03">size</a>, infs-&gt;<a class="code" href="../../d5/da7/structcplist.html#a55be9eecda16997f66a1a82c9f455364">buffer</a>, 1);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">else</span> fr = <a class="code" href="../../de/dc8/filereader_8h.html#a9194d3ea68938e5eeb48fe3d574a020c">open_filereader</a>(<a class="code" href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 1);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span>(outf){</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        out = open_file_for_write(outf, <a class="code" href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 1);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    } <span class="keywordflow">else</span> out = stdout;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#ab116f676e5cd5bbcba381f9eda24c652">run</a>(reglen, ksize, Z, W, M, X, I, D, E, H, L, XX, OO, EE, cns_model, pM, pX, pI, pD, candidate_mode, corr_struct, ncpu, fr, out);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="../../de/dc8/filereader_8h.html#a1aeaef8c01059178bf8e087d88e2ec2a">close_filereader</a>(fr);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span>(outf) fclose(out);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#aa285a02490d0ee4e5ebdc4eaea0b592e">free_cplist</a>(infs);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="../../d5/d11/mem__share_8h.html#ab6d162dc7b7ef5f1fbe55b6f28886f31">END_STAT_PROC_INFO</a>(stderr);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="filereader_8h_html_a02b5bd62773b99de59fa0bf8d7b13016"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#a02b5bd62773b99de59fa0bf8d7b13016">open_all_filereader</a></div><div class="ttdeci">static FileReader * open_all_filereader(int nfile, char **filenames, int asyn)</div><div class="ttdef"><b>Definition:</b> filereader.h:385</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_ad876cdd1a72412cf2e0d2fcde266dd9a"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#ad876cdd1a72412cf2e0d2fcde266dd9a">usage</a></div><div class="ttdeci">int usage()</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:401</div></div>
<div class="ttc" id="mem__share_8h_html_a1b45fe9ee78cf91c830b4cee25182b44"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a1b45fe9ee78cf91c830b4cee25182b44">BEG_STAT_PROC_INFO</a></div><div class="ttdeci">#define BEG_STAT_PROC_INFO(log, argc, argv)</div><div class="ttdef"><b>Definition:</b> mem_share.h:703</div></div>
<div class="ttc" id="structcplist_html_a55be9eecda16997f66a1a82c9f455364"><div class="ttname"><a href="../../d5/da7/structcplist.html#a55be9eecda16997f66a1a82c9f455364">cplist::buffer</a></div><div class="ttdeci">char ** buffer</div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="dbgcns_8h_html_ac55238ccab99c929dd5e7f52ade8031c"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#ac55238ccab99c929dd5e7f52ade8031c">DBGCNS_DEBUG</a></div><div class="ttdeci">static int DBGCNS_DEBUG</div><div class="ttdef"><b>Definition:</b> dbgcns.h:36</div></div>
<div class="ttc" id="list_8h_html_a15e626a09f6e8a6ecacedb8a8b18c5f1"><div class="ttname"><a href="../../da/d23/list_8h.html#a15e626a09f6e8a6ecacedb8a8b18c5f1">init_cplist</a></div><div class="ttdeci">static cplist * init_cplist(size_t init_size)</div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="filereader_8h_html_a1aeaef8c01059178bf8e087d88e2ec2a"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#a1aeaef8c01059178bf8e087d88e2ec2a">close_filereader</a></div><div class="ttdeci">#define close_filereader(fr)</div><div class="ttdef"><b>Definition:</b> filereader.h:393</div></div>
<div class="ttc" id="structcplist_html"><div class="ttname"><a href="../../d5/da7/structcplist.html">cplist</a></div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_ab5bf04e3e0d37f0501376b7da51d1c88"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#ab5bf04e3e0d37f0501376b7da51d1c88">MCNS_TASK_DBGCNS</a></div><div class="ttdeci">#define MCNS_TASK_DBGCNS</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:27</div></div>
<div class="ttc" id="filereader_8h_html_a9194d3ea68938e5eeb48fe3d574a020c"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#a9194d3ea68938e5eeb48fe3d574a020c">open_filereader</a></div><div class="ttdeci">static FileReader * open_filereader(char *filename, int asyn)</div><div class="ttdef"><b>Definition:</b> filereader.h:367</div></div>
<div class="ttc" id="list_8h_html_a8b81c5bd445e9e9094799235e991d382"><div class="ttname"><a href="../../da/d23/list_8h.html#a8b81c5bd445e9e9094799235e991d382">push_cplist</a></div><div class="ttdeci">static void push_cplist(cplist *list, char *e)</div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="mem__share_8h_html_ab6d162dc7b7ef5f1fbe55b6f28886f31"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#ab6d162dc7b7ef5f1fbe55b6f28886f31">END_STAT_PROC_INFO</a></div><div class="ttdeci">#define END_STAT_PROC_INFO(log)</div><div class="ttdef"><b>Definition:</b> mem_share.h:734</div></div>
<div class="ttc" id="struct_file_reader_html"><div class="ttname"><a href="../../d0/d01/struct_file_reader.html">FileReader</a></div><div class="ttdef"><b>Definition:</b> filereader.h:75</div></div>
<div class="ttc" id="struct__proc__deamon__struct_html_a20db1d7c8ffe40a71fa8d3de19b353ac"><div class="ttname"><a href="../../df/d18/struct__proc__deamon__struct.html#a20db1d7c8ffe40a71fa8d3de19b353ac">_proc_deamon_struct::ncpu</a></div><div class="ttdeci">int ncpu</div><div class="ttdef"><b>Definition:</b> mem_share.h:582</div></div>
<div class="ttc" id="mem__share_8h_html_a1a05ede2ad100bf5de5dfa7ccdfa4397"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a></div><div class="ttdeci">return NULL</div><div class="ttdef"><b>Definition:</b> mem_share.h:678</div></div>
<div class="ttc" id="list_8h_html_aa285a02490d0ee4e5ebdc4eaea0b592e"><div class="ttname"><a href="../../da/d23/list_8h.html#aa285a02490d0ee4e5ebdc4eaea0b592e">free_cplist</a></div><div class="ttdeci">static void free_cplist(cplist *list)</div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="mem__share_8h_html_a7ff6daf3b936c1306fb6e71573f0d7aa"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a7ff6daf3b936c1306fb6e71573f0d7aa">_sig_proc_deamon</a></div><div class="ttdeci">static struct _proc_deamon_struct * _sig_proc_deamon</div><div class="ttdef"><b>Definition:</b> mem_share.h:590</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_af93b0552c2b23f6fd2b5d2c0ccb5ff10"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a></div><div class="ttdeci">static int cns_debug</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:25</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_a1523b96cc68bc9d33539aa387954b4ad"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#a1523b96cc68bc9d33539aa387954b4ad">MCNS_TASK_DAGCNS</a></div><div class="ttdeci">#define MCNS_TASK_DAGCNS</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:28</div></div>
<div class="ttc" id="structcplist_html_a43eaff655ac08b43e10a66b4a408cc03"><div class="ttname"><a href="../../d5/da7/structcplist.html#a43eaff655ac08b43e10a66b4a408cc03">cplist::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> list.h:582</div></div>
<div class="ttc" id="mem__share_8h_html_ab0d4613361afe51762de34366b933fa0"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a></div><div class="ttdeci">float f4i</div><div class="ttdef"><b>Definition:</b> mem_share.h:82</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_ab116f676e5cd5bbcba381f9eda24c652"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#ab116f676e5cd5bbcba381f9eda24c652">run</a></div><div class="ttdeci">uint32_t run(int reglen, int ksize, int Z, int W, int M, int X, int I, int D, int E, int H, int L, int XX, int OO, int EE, int cns_model, f4i pM, f4i pX, f4i pI, f4i pD, int candidate_mode, int corr_struct, uint32_t ncpu, FileReader *fr, FILE *out)</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:190</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3009bdcad257eddc048095708cfaa4d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3009bdcad257eddc048095708cfaa4d0">&#9670;&nbsp;</a></span>revise_joint_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int revise_joint_point </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d23/structu32list.html">u32list</a> *&#160;</td>
          <td class="paramname"><em>cigars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>te</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                         {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a> i, op, ln, max;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">int</span> qq, q, tt, t;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    q = t = 0;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    qq = tt = 0;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    max = 0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span>(i=1;i&lt;=cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a>;i++){</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        op = cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">buffer</a>[cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a> - i] &amp; 0xF;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        ln = cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">buffer</a>[cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a> - i] &gt;&gt; 4;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span>(op == 0){</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span>(ln &gt; max){</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                qq = q; tt = t;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                max = ln;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            q += ln;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            t += ln;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(op == 1){</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            q += ln;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            t += ln;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;qe = %d -&gt; %d\n&quot;</span>, *qe, (*qe) - qq);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;te = %d -&gt; %d\n&quot;</span>, *te, (*te) - tt);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        fflush(stderr);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    *qe -= qq;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    *te -= tt;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div><div class="ttc" id="structu32list_html_a35789891f0e5e848d9698e2660bad12c"><div class="ttname"><a href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">u32list::buffer</a></div><div class="ttdeci">u4i * buffer</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="structu32list_html_a03f73e66aa16380b96088fdbee971b43"><div class="ttname"><a href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">u32list::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="mem__share_8h_html_a54365619e55e00d51db0a60bc8b0049f"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a></div><div class="ttdeci">uint32_t u4i</div><div class="ttdef"><b>Definition:</b> mem_share.h:65</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_af93b0552c2b23f6fd2b5d2c0ccb5ff10"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a></div><div class="ttdeci">static int cns_debug</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:25</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95523c16ce0cffc8057aa897a81b828b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95523c16ce0cffc8057aa897a81b828b">&#9670;&nbsp;</a></span>revise_joint_point2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int revise_joint_point2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d23/structu32list.html">u32list</a> *&#160;</td>
          <td class="paramname"><em>cigars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>te</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>overhang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                                        {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a> i, op, ln;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">int</span> qq, q, tt, t;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    q = t = 0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    qq = tt = 0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span>(i=1;i&lt;=cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a>;i++){</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        op = cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">buffer</a>[cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a> - i] &amp; 0xF;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        ln = cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">buffer</a>[cigars-&gt;<a class="code" href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">size</a> - i] &gt;&gt; 4;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">switch</span>(op){</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">case</span> 1: q += ln; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">case</span> 2: t += ln; <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">default</span>: qq = q; tt = t; q += ln; t += ln;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span>(q &gt;= overhang &amp;&amp; t &gt;= overhang){</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;qe = %d -&gt; %d\n&quot;</span>, *qe, (*qe) - qq);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;te = %d -&gt; %d\n&quot;</span>, *te, (*te) - tt);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                fflush(stderr);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            *qe -= qq;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            *te -= tt;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="ttc" id="structu32list_html_a35789891f0e5e848d9698e2660bad12c"><div class="ttname"><a href="../../de/d23/structu32list.html#a35789891f0e5e848d9698e2660bad12c">u32list::buffer</a></div><div class="ttdeci">u4i * buffer</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="structu32list_html_a03f73e66aa16380b96088fdbee971b43"><div class="ttname"><a href="../../de/d23/structu32list.html#a03f73e66aa16380b96088fdbee971b43">u32list::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="mem__share_8h_html_a54365619e55e00d51db0a60bc8b0049f"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a></div><div class="ttdeci">uint32_t u4i</div><div class="ttdef"><b>Definition:</b> mem_share.h:65</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_af93b0552c2b23f6fd2b5d2c0ccb5ff10"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a></div><div class="ttdeci">static int cns_debug</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:25</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab116f676e5cd5bbcba381f9eda24c652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab116f676e5cd5bbcba381f9eda24c652">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t run </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reglen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>XX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>OO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>EE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cns_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a>&#160;</td>
          <td class="paramname"><em>pM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a>&#160;</td>
          <td class="paramname"><em>pX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a>&#160;</td>
          <td class="paramname"><em>pI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d11/mem__share_8h.html#ab0d4613361afe51762de34366b933fa0">f4i</a>&#160;</td>
          <td class="paramname"><em>pD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>candidate_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>corr_struct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ncpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d01/struct_file_reader.html">FileReader</a> *&#160;</td>
          <td class="paramname"><em>fr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                                                                                                                                                                                                                                        {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../d1/d18/struct_string.html">String</a> *tag, *seq;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../d6/d1f/structu1v.html">u1v</a> *cseqs;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../d1/dcf/structu4v.html">u4v</a> *cxs, *cys, *tes, *qes;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    uint32_t i, m, eid, beg, end;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> c, j, sl, b, e;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">char</span> *ss;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#aa18a7628da1e5e313e610791ac235bad">thread_preprocess</a>(mcns);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    tag = <a class="code" href="../../d0/d2a/chararray_8h.html#a709ff57c9887dabacff009bb056dd1a5">init_string</a>(32);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    seq = <a class="code" href="../../d0/d2a/chararray_8h.html#a709ff57c9887dabacff009bb056dd1a5">init_string</a>(32);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    cseqs = <a class="code" href="../../da/d23/list_8h.html#a81814d93eda7bc15c5765ff8ee856b17">init_u1v</a>(32);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    cxs = <a class="code" href="../../da/d23/list_8h.html#a1ff5736440ffdb5e752851ae9e5ccc35">init_u4v</a>(32);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    cys = <a class="code" href="../../da/d23/list_8h.html#a1ff5736440ffdb5e752851ae9e5ccc35">init_u4v</a>(32);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    tes = <a class="code" href="../../da/d23/list_8h.html#a1ff5736440ffdb5e752851ae9e5ccc35">init_u4v</a>(32);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    qes = <a class="code" href="../../da/d23/list_8h.html#a1ff5736440ffdb5e752851ae9e5ccc35">init_u4v</a>(32);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#a9204fe98cd14ab75c6ef4da5bcb84265">thread_beg_init</a>(mcns, ncpu);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    mcns-&gt;eid = 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    mcns-&gt;cns = <a class="code" href="../../d3/d39/dbgcns_8h.html#a210e7474cd0fb5104a10915490282bbd">init_cns</a>(ksize, Z, W, 0, X, I, D, E, H, L);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    mcns-&gt;seq1 = <a class="code" href="../../da/d23/list_8h.html#a81814d93eda7bc15c5765ff8ee856b17">init_u1v</a>(32);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    mcns-&gt;seq2 = <a class="code" href="../../da/d23/list_8h.html#a81814d93eda7bc15c5765ff8ee856b17">init_u1v</a>(32);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    mcns-&gt;node1 = 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    mcns-&gt;node2 = 0;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    mcns-&gt;reglen = reglen;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    mcns-&gt;W = 128;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    mcns-&gt;M = M;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    mcns-&gt;X = XX;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    mcns-&gt;I = OO;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    mcns-&gt;D = OO;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    mcns-&gt;E = EE;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    mcns-&gt;pM = pM;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    mcns-&gt;pX = pX;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    mcns-&gt;pI = pI;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    mcns-&gt;pD = pD;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    mcns-&gt;candidate_mode = candidate_mode;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    mcns-&gt;corr_struct = corr_struct;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    mcns-&gt;ret = <a class="code" href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    mcns-&gt;cigars = <a class="code" href="../../da/d23/list_8h.html#a5e120a12bd11f19e6c16edecf7968959">init_u32list</a>(16);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    mcns-&gt;task = 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#ab9ef7c402ae5c49686144d3d896d24de">thread_end_init</a>(mcns);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    eid = 0;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#a0815de62182b0cec2e0f834c88cea5ba">thread_wait_one</a>(mcns);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">while</span>(1){</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        c = <a class="code" href="../../de/dc8/filereader_8h.html#ad5bfba0f80e929e901c7643cf413b3bf">readtable_filereader</a>(fr);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span>(c == -1 || fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;E&#39;</span> || fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;&gt;&#39;</span>){</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="../../db/dd5/thread_8h.html#a01b5a389958e851071e1340871d5d3c9">thread_wake</a>(mcns);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="../../db/dd5/thread_8h.html#a0815de62182b0cec2e0f834c88cea5ba">thread_wait_one</a>(mcns);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span>(mcns-&gt;task == cns_model &amp;&amp; mcns-&gt;cns-&gt;seq-&gt;size){</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    fprintf(stderr, <span class="stringliteral">&quot;%s_%d_N%u_N%u\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%s\n&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid, mcns-&gt;node1, mcns-&gt;node2, mcns-&gt;cns-&gt;qlen, mcns-&gt;cns-&gt;seq-&gt;size, mcns-&gt;cns-&gt;max_score, mcns-&gt;cns-&gt;alns[0], mcns-&gt;cns-&gt;alns[1], mcns-&gt;cns-&gt;alns[2], mcns-&gt;cns-&gt;alns[3], mcns-&gt;cns-&gt;seq-&gt;string);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a1c3a966f2f49b369b3b4e2cc951ee24f">size</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">for</span>(j=0;j&lt;mcns-&gt;cns-&gt;seq-&gt;size;j++) <a class="code" href="../../da/d23/list_8h.html#acda7364ec73badd86762f0042ffd3fb3">push_u1v</a>(cseqs, <a class="code" href="../../d0/df5/dna_8h.html#a03b6020cf885a8a225703ee21fd1e1ea">base_bit_table</a>[(<span class="keywordtype">int</span>)mcns-&gt;cns-&gt;seq-&gt;string[j]]);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                cys-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a1c3a966f2f49b369b3b4e2cc951ee24f">size</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="../../d3/d39/dbgcns_8h.html#a125a899a3a99196f60b5319b7b59d5c7">reset_cns</a>(mcns-&gt;cns);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(mcns-&gt;cns-&gt;seq);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            mcns-&gt;task = cns_model;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            mcns-&gt;eid = eid ++;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(cxs, 0);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(cys, 0);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">if</span>(fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;E&#39;</span>){</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                mcns-&gt;node1 = atoll(<a class="code" href="../../de/dc8/filereader_8h.html#a235c7ddeeadf6cb80e4e957de8e5015f">get_col_str</a>(fr, 2) + 1);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                mcns-&gt;node2 = atoll(<a class="code" href="../../de/dc8/filereader_8h.html#a235c7ddeeadf6cb80e4e957de8e5015f">get_col_str</a>(fr, 4) + 1);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">if</span>(tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a>){</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#afc3f1b87b49f4cf962a1668a026f1767">thread_beg_iter</a>(mcns);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#aee8250becae4ad81ef8dace0c6a42744">thread_wait</a>(mcns);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">if</span>(mcns-&gt;task == cns_model &amp;&amp; mcns-&gt;cns-&gt;seq-&gt;size){</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        <span class="comment">//fprintf(stderr, &quot;%s_%d\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%s\n&quot;, tag-&gt;string, mcns-&gt;eid, mcns-&gt;cns-&gt;qlen, mcns-&gt;cns-&gt;seq-&gt;size, mcns-&gt;cns-&gt;max_score, mcns-&gt;cns-&gt;alns[0], mcns-&gt;cns-&gt;alns[1], mcns-&gt;cns-&gt;alns[2], mcns-&gt;cns-&gt;alns[3], mcns-&gt;cns-&gt;seq-&gt;string);</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;%s_%d_N%u_N%u\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%s\n&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid, mcns-&gt;node1, mcns-&gt;node2, mcns-&gt;cns-&gt;qlen, mcns-&gt;cns-&gt;seq-&gt;size, mcns-&gt;cns-&gt;max_score, mcns-&gt;cns-&gt;alns[0], mcns-&gt;cns-&gt;alns[1], mcns-&gt;cns-&gt;alns[2], mcns-&gt;cns-&gt;alns[3], mcns-&gt;cns-&gt;seq-&gt;string);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        <span class="keywordflow">if</span>(0){</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                            <a class="code" href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a> j, x;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                            <span class="keywordflow">for</span>(j=x=0;j&lt;mcns-&gt;cns-&gt;cigars-&gt;size;j++){</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                <span class="keywordflow">if</span>(mcns-&gt;cns-&gt;cigars-&gt;buffer[j] == <a class="code" href="../../d3/d39/dbgcns_8h.html#ad7653bcf400a33990432a44533d86223">DBGCNS_PATH_I</a>){</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                    fputc(<span class="charliteral">&#39;-&#39;</span>, stderr);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                    fputc(<span class="stringliteral">&quot;ACGT&quot;</span>[mcns-&gt;cns-&gt;cns-&gt;buffer[x]], stderr); x ++;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                            }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                            fputc(<span class="charliteral">&#39;\n&#39;</span>, stderr);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                            <span class="keywordflow">for</span>(j=0;j&lt;mcns-&gt;cns-&gt;cigars-&gt;size;j++){</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                                fputc(<span class="stringliteral">&quot;MXID&quot;</span>[mcns-&gt;cns-&gt;cigars-&gt;buffer[j]], stderr);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                            }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                            fputc(<span class="charliteral">&#39;\n&#39;</span>, stderr);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                        }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a1c3a966f2f49b369b3b4e2cc951ee24f">size</a>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="keywordflow">for</span>(j=0;j&lt;mcns-&gt;cns-&gt;seq-&gt;size;j++) <a class="code" href="../../da/d23/list_8h.html#acda7364ec73badd86762f0042ffd3fb3">push_u1v</a>(cseqs, <a class="code" href="../../d0/df5/dna_8h.html#a03b6020cf885a8a225703ee21fd1e1ea">base_bit_table</a>[(<span class="keywordtype">int</span>)mcns-&gt;cns-&gt;seq-&gt;string[j]]);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    cys-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a1c3a966f2f49b369b3b4e2cc951ee24f">size</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <a class="code" href="../../d3/d39/dbgcns_8h.html#a125a899a3a99196f60b5319b7b59d5c7">reset_cns</a>(mcns-&gt;cns);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(mcns-&gt;cns-&gt;seq);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                mcns-&gt;eid = 0;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                mcns-&gt;task = 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                mcns-&gt;node1 = 0;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                mcns-&gt;node2 = 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#a905862f2370a598da8b0b703d661061e">thread_end_iter</a>(mcns);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(qes, 0);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(tes, 0);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keywordflow">for</span>(i=1;i&lt;eid;i++){</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="../../db/dd5/thread_8h.html#a0815de62182b0cec2e0f834c88cea5ba">thread_wait_one</a>(mcns);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <span class="keywordflow">if</span>(mcns-&gt;task == <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a> &amp;&amp; mcns-&gt;ret.aln &gt; 0){</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                        <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                            fprintf(stderr, <span class="stringliteral">&quot;#%s_%d\t%d\t%d\t%d&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid - 1, (<span class="keywordtype">int</span>)mcns-&gt;seq1-&gt;size, mcns-&gt;ret.qb, mcns-&gt;ret.qe);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            fprintf(stderr, <span class="stringliteral">&quot;\t%s_%d\t%d\t%d\t%d&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid, (<span class="keywordtype">int</span>)mcns-&gt;seq2-&gt;size, mcns-&gt;ret.tb, mcns-&gt;ret.te);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            fprintf(stderr, <span class="stringliteral">&quot;\t%d\t%d\t%d\t%d\t%d\n&quot;</span>, mcns-&gt;ret.aln, mcns-&gt;ret.mat, mcns-&gt;ret.mis, mcns-&gt;ret.ins, mcns-&gt;ret.del);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                        {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                            b = mcns-&gt;ret.qe;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            e = mcns-&gt;ret.te;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                            <span class="keywordflow">if</span>(1){</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a3009bdcad257eddc048095708cfaa4d0">revise_joint_point</a>(mcns-&gt;cigars, &amp;b, &amp;e);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                            }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                            qes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = b;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                            tes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = e;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    mcns-&gt;task = <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    mcns-&gt;eid = i;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    <a class="code" href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a>(mcns-&gt;seq1); <a class="code" href="../../da/d23/list_8h.html#a527534f07d6622656f8e182e54bae8c6">append_array_u1v</a>(mcns-&gt;seq1, cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a56baa1e790d18c1f40da50ff4a86a309">buffer</a> + cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i-1], cys-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i-1] - cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i-1]);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <a class="code" href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a>(mcns-&gt;seq2); <a class="code" href="../../da/d23/list_8h.html#a527534f07d6622656f8e182e54bae8c6">append_array_u1v</a>(mcns-&gt;seq2, cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a56baa1e790d18c1f40da50ff4a86a309">buffer</a> + cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i], cys-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i] - cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i]);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    mcns-&gt;ret = <a class="code" href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(qes, mcns-&gt;seq1-&gt;size);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(tes, 0);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    <a class="code" href="../../db/dd5/thread_8h.html#a01b5a389958e851071e1340871d5d3c9">thread_wake</a>(mcns);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(qes, cys-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[eid-1] - cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[eid-1]);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <a class="code" href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a>(tes, 0);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#afc3f1b87b49f4cf962a1668a026f1767">thread_beg_iter</a>(mcns);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#aee8250becae4ad81ef8dace0c6a42744">thread_wait</a>(mcns);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">if</span>(mcns-&gt;task == <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a> &amp;&amp; mcns-&gt;ret.aln &gt; 0){</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;#%s_%d\t%d\t%d\t%d&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid - 1, (<span class="keywordtype">int</span>)mcns-&gt;seq1-&gt;size, mcns-&gt;ret.qb, mcns-&gt;ret.qe);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\t%s_%d\t%d\t%d\t%d&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, mcns-&gt;eid, (<span class="keywordtype">int</span>)mcns-&gt;seq2-&gt;size, mcns-&gt;ret.tb, mcns-&gt;ret.te);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;\t%d\t%d\t%d\t%d\t%d\n&quot;</span>, mcns-&gt;ret.aln, mcns-&gt;ret.mat, mcns-&gt;ret.mis, mcns-&gt;ret.ins, mcns-&gt;ret.del);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        b = mcns-&gt;ret.qe;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        e = mcns-&gt;ret.te;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        <span class="keywordflow">if</span>(1){</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                            <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a3009bdcad257eddc048095708cfaa4d0">revise_joint_point</a>(mcns-&gt;cigars, &amp;b, &amp;e);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        qes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = b;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        tes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[mcns-&gt;eid] = e;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                mcns-&gt;ret = <a class="code" href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                mcns-&gt;eid = 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                mcns-&gt;task = 0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <a class="code" href="../../db/dd5/thread_8h.html#a905862f2370a598da8b0b703d661061e">thread_end_iter</a>(mcns);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                <span class="comment">// generate contig seq</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(seq);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                <span class="keywordflow">for</span>(i=0;i&lt;eid;i++){</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    beg = cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i] + tes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i];</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    end = cxs-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i] + qes-&gt;<a class="code" href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">buffer</a>[i + 1];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keywordflow">for</span>(m=beg;m&lt;end;m++){</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        <a class="code" href="../../d0/d2a/chararray_8h.html#a283f94bbb8a4101c95f00c188c180683">push_string</a>(seq, <a class="code" href="../../d0/df5/dna_8h.html#a905dc090c739b2a74eb5ad8a08d84100">bit_base_table</a>[cseqs-&gt;<a class="code" href="../../d6/d1f/structu1v.html#a56baa1e790d18c1f40da50ff4a86a309">buffer</a>[m]]);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        fprintf(stderr, <span class="stringliteral">&quot;=%s_%d\t%d\t%d\n&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, i, seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a> - (end - beg), seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                fprintf(out, <span class="stringliteral">&quot;&gt;%s len=%d\n&quot;</span>, tag-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>, seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">for</span>(j=0;j&lt;seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a>;j+=100){</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    sl = <a class="code" href="../../d5/d11/mem__share_8h.html#a4d1f210e2153c29b2878f8d2029867f0">num_min</a>(j + 100, seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">size</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <span class="keywordtype">char</span> ch = seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[sl];</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[sl] = 0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    fprintf(out, <span class="stringliteral">&quot;%s\n&quot;</span>, seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a> + j);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    seq-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[sl] = ch;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">if</span>(c == -1) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(tag);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            ss = <a class="code" href="../../de/dc8/filereader_8h.html#a235c7ddeeadf6cb80e4e957de8e5015f">get_col_str</a>(fr, 0) + 1;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            sl = <a class="code" href="../../de/dc8/filereader_8h.html#a31db005a33b3d0ebcdf5c2b118843c67">get_col_len</a>(fr, 0) - 1;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">for</span>(j=0;j&lt;sl;j++){</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keywordflow">if</span>(ss[j] == <span class="charliteral">&#39; &#39;</span>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <a class="code" href="../../d0/d2a/chararray_8h.html#a283f94bbb8a4101c95f00c188c180683">push_string</a>(tag, ss[j]);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(seq);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            eid = 0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a>(cseqs);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a130e419c4b784332dcc60dcd04de316c">clear_u4v</a>(cxs);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a130e419c4b784332dcc60dcd04de316c">clear_u4v</a>(cys);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a130e419c4b784332dcc60dcd04de316c">clear_u4v</a>(tes);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="../../da/d23/list_8h.html#a130e419c4b784332dcc60dcd04de316c">clear_u4v</a>(qes);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <a class="code" href="../../db/dd5/thread_8h.html#a0815de62182b0cec2e0f834c88cea5ba">thread_wait_one</a>(mcns);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;S&#39;</span> || fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;s&#39;</span>){</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            ss = <a class="code" href="../../de/dc8/filereader_8h.html#a235c7ddeeadf6cb80e4e957de8e5015f">get_col_str</a>(fr, 5);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            sl = <a class="code" href="../../de/dc8/filereader_8h.html#a31db005a33b3d0ebcdf5c2b118843c67">get_col_len</a>(fr, 5);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="../../d3/d39/dbgcns_8h.html#abc94fa889426a6ff053f223274c148da">add_seq_cns</a>(mcns-&gt;cns, ss, sl, (fr-&gt;<a class="code" href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">line</a>-&gt;<a class="code" href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">string</a>[0] == <span class="charliteral">&#39;S&#39;</span>));</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#ab298d9f675d8524edbc03ce2d9da08c0">thread_beg_close</a>(mcns);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../d3/d39/dbgcns_8h.html#a946fdacfedd186f7fd478f6e01ada117">free_cns</a>(mcns-&gt;cns);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a>(mcns-&gt;seq1);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a>(mcns-&gt;seq2);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a4f8406c2dac820a571932ef44567618d">free_u32list</a>(mcns-&gt;cigars);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="../../db/dd5/thread_8h.html#ac1c35c02733ff8c432738a22307a99a7">thread_end_close</a>(mcns);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a>(cseqs);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a1ca5ea440b22e2de1969183d6f0277f2">free_u4v</a>(cxs);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a1ca5ea440b22e2de1969183d6f0277f2">free_u4v</a>(cys);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a1ca5ea440b22e2de1969183d6f0277f2">free_u4v</a>(tes);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a1ca5ea440b22e2de1969183d6f0277f2">free_u4v</a>(qes);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="../../d0/d2a/chararray_8h.html#ae2eaab502d895b2f5f31d66a5c7ab8d6">free_string</a>(tag);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="../../d0/d2a/chararray_8h.html#ae2eaab502d895b2f5f31d66a5c7ab8d6">free_string</a>(seq);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="ttc" id="thread_8h_html_ab298d9f675d8524edbc03ce2d9da08c0"><div class="ttname"><a href="../../db/dd5/thread_8h.html#ab298d9f675d8524edbc03ce2d9da08c0">thread_beg_close</a></div><div class="ttdeci">#define thread_beg_close(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:311</div></div>
<div class="ttc" id="structu4v_html_a64fa2457c936876634825804ac0f0b74"><div class="ttname"><a href="../../d1/dcf/structu4v.html#a64fa2457c936876634825804ac0f0b74">u4v::buffer</a></div><div class="ttdeci">u4i * buffer</div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
<div class="ttc" id="list_8h_html_a5e120a12bd11f19e6c16edecf7968959"><div class="ttname"><a href="../../da/d23/list_8h.html#a5e120a12bd11f19e6c16edecf7968959">init_u32list</a></div><div class="ttdeci">static u32list * init_u32list(size_t init_size)</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="thread_8h_html_a9204fe98cd14ab75c6ef4da5bcb84265"><div class="ttname"><a href="../../db/dd5/thread_8h.html#a9204fe98cd14ab75c6ef4da5bcb84265">thread_beg_init</a></div><div class="ttdeci">#define thread_beg_init(tname, n_thread)</div><div class="ttdef"><b>Definition:</b> thread.h:176</div></div>
<div class="ttc" id="list_8h_html_acda7364ec73badd86762f0042ffd3fb3"><div class="ttname"><a href="../../da/d23/list_8h.html#acda7364ec73badd86762f0042ffd3fb3">push_u1v</a></div><div class="ttdeci">static void push_u1v(u1v *list, u1i e)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="struct_string_html_af7f7c03caa6a42b9b758df72b271e3e9"><div class="ttname"><a href="../../d1/d18/struct_string.html#af7f7c03caa6a42b9b758df72b271e3e9">String::string</a></div><div class="ttdeci">char * string</div><div class="ttdef"><b>Definition:</b> chararray.h:42</div></div>
<div class="ttc" id="structu1v_html_a56baa1e790d18c1f40da50ff4a86a309"><div class="ttname"><a href="../../d6/d1f/structu1v.html#a56baa1e790d18c1f40da50ff4a86a309">u1v::buffer</a></div><div class="ttdeci">u1i * buffer</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="chararray_8h_html_a709ff57c9887dabacff009bb056dd1a5"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#a709ff57c9887dabacff009bb056dd1a5">init_string</a></div><div class="ttdeci">static String * init_string(string_size_t cap)</div><div class="ttdef"><b>Definition:</b> chararray.h:53</div></div>
<div class="ttc" id="dbgcns_8h_html_a125a899a3a99196f60b5319b7b59d5c7"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#a125a899a3a99196f60b5319b7b59d5c7">reset_cns</a></div><div class="ttdeci">static void reset_cns(CNS *cns)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:390</div></div>
<div class="ttc" id="list_8h_html_a527534f07d6622656f8e182e54bae8c6"><div class="ttname"><a href="../../da/d23/list_8h.html#a527534f07d6622656f8e182e54bae8c6">append_array_u1v</a></div><div class="ttdeci">static void append_array_u1v(u1v *list1, u1i *ary, size_t size)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="dbgcns_8h_html_a210e7474cd0fb5104a10915490282bbd"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#a210e7474cd0fb5104a10915490282bbd">init_cns</a></div><div class="ttdeci">static CNS * init_cns(uint32_t ksize, int Z, int W, int M, int X, int I, int D, int E, int H, int L)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:325</div></div>
<div class="ttc" id="thread_8h_html_afc3f1b87b49f4cf962a1668a026f1767"><div class="ttname"><a href="../../db/dd5/thread_8h.html#afc3f1b87b49f4cf962a1668a026f1767">thread_beg_iter</a></div><div class="ttdeci">#define thread_beg_iter(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:256</div></div>
<div class="ttc" id="list_8h_html_a4f8406c2dac820a571932ef44567618d"><div class="ttname"><a href="../../da/d23/list_8h.html#a4f8406c2dac820a571932ef44567618d">free_u32list</a></div><div class="ttdeci">static void free_u32list(u32list *list)</div><div class="ttdef"><b>Definition:</b> list.h:564</div></div>
<div class="ttc" id="dna_8h_html_a03b6020cf885a8a225703ee21fd1e1ea"><div class="ttname"><a href="../../d0/df5/dna_8h.html#a03b6020cf885a8a225703ee21fd1e1ea">base_bit_table</a></div><div class="ttdeci">static const u1i base_bit_table[256]</div><div class="ttdef"><b>Definition:</b> dna.h:32</div></div>
<div class="ttc" id="struct_file_reader_html_a722e7bb9fd6c3033e8d02d72fe48d9cd"><div class="ttname"><a href="../../d0/d01/struct_file_reader.html#a722e7bb9fd6c3033e8d02d72fe48d9cd">FileReader::line</a></div><div class="ttdeci">String * line</div><div class="ttdef"><b>Definition:</b> filereader.h:89</div></div>
<div class="ttc" id="list_8h_html_a81814d93eda7bc15c5765ff8ee856b17"><div class="ttname"><a href="../../da/d23/list_8h.html#a81814d93eda7bc15c5765ff8ee856b17">init_u1v</a></div><div class="ttdeci">static u1v * init_u1v(size_t init_size)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="structu4v_html"><div class="ttname"><a href="../../d1/dcf/structu4v.html">u4v</a></div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
<div class="ttc" id="filereader_8h_html_ad5bfba0f80e929e901c7643cf413b3bf"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#ad5bfba0f80e929e901c7643cf413b3bf">readtable_filereader</a></div><div class="ttdeci">static int readtable_filereader(FileReader *fr)</div><div class="ttdef"><b>Definition:</b> filereader.h:574</div></div>
<div class="ttc" id="thread_8h_html_a905862f2370a598da8b0b703d661061e"><div class="ttname"><a href="../../db/dd5/thread_8h.html#a905862f2370a598da8b0b703d661061e">thread_end_iter</a></div><div class="ttdeci">#define thread_end_iter(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:260</div></div>
<div class="ttc" id="thread_8h_html_a01b5a389958e851071e1340871d5d3c9"><div class="ttname"><a href="../../db/dd5/thread_8h.html#a01b5a389958e851071e1340871d5d3c9">thread_wake</a></div><div class="ttdeci">#define thread_wake(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:234</div></div>
<div class="ttc" id="list_8h_html_a1ca5ea440b22e2de1969183d6f0277f2"><div class="ttname"><a href="../../da/d23/list_8h.html#a1ca5ea440b22e2de1969183d6f0277f2">free_u4v</a></div><div class="ttdeci">static void free_u4v(u4v *list)</div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
<div class="ttc" id="thread_8h_html_aee8250becae4ad81ef8dace0c6a42744"><div class="ttname"><a href="../../db/dd5/thread_8h.html#aee8250becae4ad81ef8dace0c6a42744">thread_wait</a></div><div class="ttdeci">#define thread_wait(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:252</div></div>
<div class="ttc" id="structu1v_html_a1c3a966f2f49b369b3b4e2cc951ee24f"><div class="ttname"><a href="../../d6/d1f/structu1v.html#a1c3a966f2f49b369b3b4e2cc951ee24f">u1v::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="filereader_8h_html_a31db005a33b3d0ebcdf5c2b118843c67"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#a31db005a33b3d0ebcdf5c2b118843c67">get_col_len</a></div><div class="ttdeci">static int get_col_len(FileReader *fr, int col)</div><div class="ttdef"><b>Definition:</b> filereader.h:594</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_a2482354f5176a12970941152bef9bf54"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a></div><div class="ttdeci">#define MCNS_TASK_OVERLAP</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:29</div></div>
<div class="ttc" id="thread_8h_html_ac1c35c02733ff8c432738a22307a99a7"><div class="ttname"><a href="../../db/dd5/thread_8h.html#ac1c35c02733ff8c432738a22307a99a7">thread_end_close</a></div><div class="ttdeci">#define thread_end_close(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:312</div></div>
<div class="ttc" id="filereader_8h_html_a235c7ddeeadf6cb80e4e957de8e5015f"><div class="ttname"><a href="../../de/dc8/filereader_8h.html#a235c7ddeeadf6cb80e4e957de8e5015f">get_col_str</a></div><div class="ttdeci">static char * get_col_str(FileReader *fr, int col)</div><div class="ttdef"><b>Definition:</b> filereader.h:598</div></div>
<div class="ttc" id="struct_string_html"><div class="ttname"><a href="../../d1/d18/struct_string.html">String</a></div><div class="ttdef"><b>Definition:</b> chararray.h:41</div></div>
<div class="ttc" id="dbgcns_8h_html_a946fdacfedd186f7fd478f6e01ada117"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#a946fdacfedd186f7fd478f6e01ada117">free_cns</a></div><div class="ttdeci">static void free_cns(CNS *cns)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:369</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_a3009bdcad257eddc048095708cfaa4d0"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#a3009bdcad257eddc048095708cfaa4d0">revise_joint_point</a></div><div class="ttdeci">int revise_joint_point(u32list *cigars, int *qe, int *te)</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:131</div></div>
<div class="ttc" id="thread_8h_html_a0815de62182b0cec2e0f834c88cea5ba"><div class="ttname"><a href="../../db/dd5/thread_8h.html#a0815de62182b0cec2e0f834c88cea5ba">thread_wait_one</a></div><div class="ttdeci">#define thread_wait_one(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:290</div></div>
<div class="ttc" id="chararray_8h_html_a7eadcd55386fce9c8b49d41101d6529b"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a></div><div class="ttdeci">static void clear_string(String *str)</div><div class="ttdef"><b>Definition:</b> chararray.h:242</div></div>
<div class="ttc" id="struct_string_html_af5847b1e9a85a5f12f32e0bccd364bf0"><div class="ttname"><a href="../../d1/d18/struct_string.html#af5847b1e9a85a5f12f32e0bccd364bf0">String::size</a></div><div class="ttdeci">string_size_t size</div><div class="ttdef"><b>Definition:</b> chararray.h:43</div></div>
<div class="ttc" id="list_8h_html_a10460be87b7288e5d505fe82e4fa46f0"><div class="ttname"><a href="../../da/d23/list_8h.html#a10460be87b7288e5d505fe82e4fa46f0">push_u4v</a></div><div class="ttdeci">static void push_u4v(u4v *list, u4i e)</div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
<div class="ttc" id="list_8h_html_a4f4e8aa37ce212956c6c10f2388fbaad"><div class="ttname"><a href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a></div><div class="ttdeci">static void free_u1v(u1v *list)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="chararray_8h_html_a283f94bbb8a4101c95f00c188c180683"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#a283f94bbb8a4101c95f00c188c180683">push_string</a></div><div class="ttdeci">#define push_string(str, ch)</div><div class="ttdef"><b>Definition:</b> chararray.h:216</div></div>
<div class="ttc" id="mem__share_8h_html_a54365619e55e00d51db0a60bc8b0049f"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a54365619e55e00d51db0a60bc8b0049f">u4i</a></div><div class="ttdeci">uint32_t u4i</div><div class="ttdef"><b>Definition:</b> mem_share.h:65</div></div>
<div class="ttc" id="dbgcns_8h_html_ad7653bcf400a33990432a44533d86223"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#ad7653bcf400a33990432a44533d86223">DBGCNS_PATH_I</a></div><div class="ttdeci">#define DBGCNS_PATH_I</div><div class="ttdef"><b>Definition:</b> dbgcns.h:112</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_af93b0552c2b23f6fd2b5d2c0ccb5ff10"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a></div><div class="ttdeci">static int cns_debug</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:25</div></div>
<div class="ttc" id="kswx_8h_html_a28770cc8ecc66842766ce4a9b6d9eaef"><div class="ttname"><a href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a></div><div class="ttdeci">static const kswx_t KSWX_NULL</div><div class="ttdef"><b>Definition:</b> kswx.h:37</div></div>
<div class="ttc" id="mem__share_8h_html_a4d1f210e2153c29b2878f8d2029867f0"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a4d1f210e2153c29b2878f8d2029867f0">num_min</a></div><div class="ttdeci">#define num_min(n1, n2)</div><div class="ttdef"><b>Definition:</b> mem_share.h:95</div></div>
<div class="ttc" id="dna_8h_html_a905dc090c739b2a74eb5ad8a08d84100"><div class="ttname"><a href="../../d0/df5/dna_8h.html#a905dc090c739b2a74eb5ad8a08d84100">bit_base_table</a></div><div class="ttdeci">static const char bit_base_table[12]</div><div class="ttdef"><b>Definition:</b> dna.h:78</div></div>
<div class="ttc" id="list_8h_html_a1ff5736440ffdb5e752851ae9e5ccc35"><div class="ttname"><a href="../../da/d23/list_8h.html#a1ff5736440ffdb5e752851ae9e5ccc35">init_u4v</a></div><div class="ttdeci">static u4v * init_u4v(size_t init_size)</div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
<div class="ttc" id="list_8h_html_a0393398de16907e0362767fd47746653"><div class="ttname"><a href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a></div><div class="ttdeci">static void clear_u1v(u1v *list)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="dbgcns_8h_html_abc94fa889426a6ff053f223274c148da"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#abc94fa889426a6ff053f223274c148da">add_seq_cns</a></div><div class="ttdeci">static void add_seq_cns(CNS *cns, char *seq, int len, int solid)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:403</div></div>
<div class="ttc" id="thread_8h_html_aa18a7628da1e5e313e610791ac235bad"><div class="ttname"><a href="../../db/dd5/thread_8h.html#aa18a7628da1e5e313e610791ac235bad">thread_preprocess</a></div><div class="ttdeci">#define thread_preprocess(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:144</div></div>
<div class="ttc" id="structu1v_html"><div class="ttname"><a href="../../d6/d1f/structu1v.html">u1v</a></div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="thread_8h_html_ab9ef7c402ae5c49686144d3d896d24de"><div class="ttname"><a href="../../db/dd5/thread_8h.html#ab9ef7c402ae5c49686144d3d896d24de">thread_end_init</a></div><div class="ttdeci">#define thread_end_init(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:178</div></div>
<div class="ttc" id="chararray_8h_html_ae2eaab502d895b2f5f31d66a5c7ab8d6"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#ae2eaab502d895b2f5f31d66a5c7ab8d6">free_string</a></div><div class="ttdeci">static void free_string(String *str)</div><div class="ttdef"><b>Definition:</b> chararray.h:350</div></div>
<div class="ttc" id="list_8h_html_a130e419c4b784332dcc60dcd04de316c"><div class="ttname"><a href="../../da/d23/list_8h.html#a130e419c4b784332dcc60dcd04de316c">clear_u4v</a></div><div class="ttdeci">static void clear_u4v(u4v *list)</div><div class="ttdef"><b>Definition:</b> list.h:565</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aecc81f50869379760e5611c76b20a877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc81f50869379760e5611c76b20a877">&#9670;&nbsp;</a></span>thread_mcns_func()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* thread_mcns_func </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                  {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="../../d3/d39/dbgcns_8h.html#a27a95978b399b6780ef0eec118cd0133">ready_cns</a>(cns);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="../../d3/d39/dbgcns_8h.html#a247df407c8dfb0eed8401fc7ea9bd782">run_cns</a>(cns, mcns-&gt;candidate_mode, mcns-&gt;corr_struct);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;} <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mcns-&gt;task == <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a1523b96cc68bc9d33539aa387954b4ad">MCNS_TASK_DAGCNS</a>){</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// force mcns-&gt;candidate_mode to 2</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// use data from DBGCNS struct</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="../../d3/d39/dbgcns_8h.html#a27a95978b399b6780ef0eec118cd0133">ready_cns</a>(cns);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a9e7fca0dadad24a8e91c1daed8114546">clear_u8list</a>(dag-&gt;cns);</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    blk = <a class="code" href="../../d3/d39/dbgcns_8h.html#aff654bf750dfba2eb959b1b964a10ef4">ref_blkv</a>(cns-&gt;qblks, 0);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#ac6ac74130ca16fd29c2c39249511d7c0">append_array_u8list</a>(dag-&gt;cns, cns-&gt;qseqs-&gt;buffer + blk-&gt;off, blk-&gt;len);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../d0/d48/dagcns_8h.html#a7e8404daaa55d9c73aacd6a899bb4adc">gen_pregraph_dagcns</a>(dag);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span>(i=1;i&lt;cns-&gt;qblks-&gt;size;i++){</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        blk = <a class="code" href="../../d3/d39/dbgcns_8h.html#aff654bf750dfba2eb959b1b964a10ef4">ref_blkv</a>(mcns-&gt;cns-&gt;qblks, i);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        nbeg = <a class="code" href="../../d0/d48/dagcns_8h.html#a7c104b73f7512123f6370409bf345b80">branched_dynamic_programming_alignment</a>(dag, mcns-&gt;cns-&gt;qseqs-&gt;buffer + blk-&gt;off, blk-&gt;len, g, bnodes, bedges, mem_buffer);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span>(nbeg == 0){</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot; -- something wrong in %s -- %s:%d --\n&quot;</span>, __FUNCTION__, __FILE__, __LINE__); fflush(stderr);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="../../d0/d48/dagcns_8h.html#a76b1d7e2b1eaf45e393bdf37a5392c1d">bdpgraph2dagcns</a>(dag, g, bnodes, bedges, nbeg, linkstack);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="../../d0/d48/dagcns_8h.html#a95241c72c49089ed51b73cdd282b17d2">merge_nodes_dagcns</a>(dag);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="../../d0/d48/dagcns_8h.html#a39db1778c32df87fe0fc982eb7231c83">gen_consensus_dagcns</a>(dag, <a class="code" href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a>){</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;DAG%d\t%d\t&quot;</span>, mcns-&gt;eid, (<span class="keywordtype">int</span>)dag-&gt;cns-&gt;size);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="../../d0/d48/dagcns_8h.html#ad89107b73021e456c494bc1fd70aa992">print_seq_dagcns</a>(dag, stderr);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a>(mcns-&gt;cns-&gt;cns);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="../../da/d23/list_8h.html#a155857c4504786ebae8fb772a8e8f20a">append_u1v</a>(mcns-&gt;cns-&gt;cns, (<a class="code" href="../../d6/d1f/structu1v.html">u1v</a>*)dag-&gt;cns);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a>(mcns-&gt;cns-&gt;seq);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span>(i=0;i&lt;dag-&gt;cns-&gt;size;i++) <a class="code" href="../../d0/d2a/chararray_8h.html#a44d90846173ac16facc9f4fa189f4e95">add_char_string</a>(mcns-&gt;cns-&gt;seq, <a class="code" href="../../d0/df5/dna_8h.html#a905dc090c739b2a74eb5ad8a08d84100">bit_base_table</a>[dag-&gt;cns-&gt;buffer[i]]);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;} <span class="keywordflow">else</span> <span class="keywordflow">if</span>(mcns-&gt;task == <a class="code" href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a>){</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span>(mcns-&gt;seq2-&gt;size == 0){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        mcns-&gt;ret = <a class="code" href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    qb = 0; qe = mcns-&gt;seq1-&gt;size;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    tb = 0; te = mcns-&gt;seq2-&gt;size;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span>(qe &gt; mcns-&gt;reglen) qb = qe - mcns-&gt;reglen;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span>(te &gt; mcns-&gt;reglen) te = mcns-&gt;reglen;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="../../d2/df4/kswx_8h.html#ac7402c48a08189d15a03d10517934092">kswx_overlap_align_core</a>(xs, cigars, qe - qb, mcns-&gt;seq1-&gt;buffer + qb, te - tb, mcns-&gt;seq2-&gt;buffer + tb, 1, mcns-&gt;M, mcns-&gt;X, mcns-&gt;I, mcns-&gt;D, mcns-&gt;E, mem_cache);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    xs[0]-&gt;qb += qb;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    xs[0]-&gt;qe += qb;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    xs[0]-&gt;tb += tb;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    xs[0]-&gt;te += tb;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    mcns-&gt;ret = *xs[0];</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<a class="code" href="../../db/dd5/thread_8h.html#a7bf56da822d1f545f533c7b544129d43">thread_end_loop</a>(mcns);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;free(xs[0]);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<a class="code" href="../../da/d23/list_8h.html#a58278c96876189b1431fb4ffab2e83fa">free_u8list</a>(mem_cache);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<a class="code" href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a>(mem_buffer);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<a class="code" href="../../d0/d48/dagcns_8h.html#a4c90e5d9e802a7158756843e9988f807">free_dagcns</a>(dag);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<a class="code" href="../../d4/deb/general__graph_8h.html#aca828d8168e3c247b8a551abaa14d1ce">free_gegraph</a>(g);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<a class="code" href="../../d0/d48/dagcns_8h.html#a2304cc36c5ba97fd5e408ec86327d342">free_bdpnodev</a>(bnodes);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<a class="code" href="../../d0/d48/dagcns_8h.html#a261fff6940fdd0aac6377e6efe9e4185">free_bdpedgev</a>(bedges);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<a class="code" href="../../d0/d48/dagcns_8h.html#a15b4f699945f0b1de6ac0deb9b55d243">free_bdplinkv</a>(linkstack);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<a class="code" href="../../db/dd5/thread_8h.html#abe73a1c52172dec771ce6ee4ccae4b0e">thread_end_func</a>(mcns);</div><div class="ttc" id="dbgcns_8h_html_aff654bf750dfba2eb959b1b964a10ef4"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#aff654bf750dfba2eb959b1b964a10ef4">ref_blkv</a></div><div class="ttdeci">static blk_t * ref_blkv(blkv *list, size_t idx)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:136</div></div>
<div class="ttc" id="list_8h_html_ac6ac74130ca16fd29c2c39249511d7c0"><div class="ttname"><a href="../../da/d23/list_8h.html#ac6ac74130ca16fd29c2c39249511d7c0">append_array_u8list</a></div><div class="ttdeci">static void append_array_u8list(u8list *list1, u1i *ary, size_t size)</div><div class="ttdef"><b>Definition:</b> list.h:560</div></div>
<div class="ttc" id="dagcns_8h_html_a261fff6940fdd0aac6377e6efe9e4185"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a261fff6940fdd0aac6377e6efe9e4185">free_bdpedgev</a></div><div class="ttdeci">static void free_bdpedgev(bdpedgev *list)</div><div class="ttdef"><b>Definition:</b> dagcns.h:47</div></div>
<div class="ttc" id="dagcns_8h_html_a95241c72c49089ed51b73cdd282b17d2"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a95241c72c49089ed51b73cdd282b17d2">merge_nodes_dagcns</a></div><div class="ttdeci">static void merge_nodes_dagcns(DAGCNS *g)</div><div class="ttdef"><b>Definition:</b> dagcns.h:751</div></div>
<div class="ttc" id="dbgcns_8h_html_a27a95978b399b6780ef0eec118cd0133"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#a27a95978b399b6780ef0eec118cd0133">ready_cns</a></div><div class="ttdeci">static void ready_cns(CNS *cns)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:413</div></div>
<div class="ttc" id="thread_8h_html_a7bf56da822d1f545f533c7b544129d43"><div class="ttname"><a href="../../db/dd5/thread_8h.html#a7bf56da822d1f545f533c7b544129d43">thread_end_loop</a></div><div class="ttdeci">#define thread_end_loop(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:129</div></div>
<div class="ttc" id="dagcns_8h_html_a7e8404daaa55d9c73aacd6a899bb4adc"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a7e8404daaa55d9c73aacd6a899bb4adc">gen_pregraph_dagcns</a></div><div class="ttdeci">static void gen_pregraph_dagcns(DAGCNS *g)</div><div class="ttdef"><b>Definition:</b> dagcns.h:206</div></div>
<div class="ttc" id="dagcns_8h_html_a39db1778c32df87fe0fc982eb7231c83"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a39db1778c32df87fe0fc982eb7231c83">gen_consensus_dagcns</a></div><div class="ttdeci">static void gen_consensus_dagcns(DAGCNS *g, u32list *map)</div><div class="ttdef"><b>Definition:</b> dagcns.h:818</div></div>
<div class="ttc" id="general__graph_8h_html_aca828d8168e3c247b8a551abaa14d1ce"><div class="ttname"><a href="../../d4/deb/general__graph_8h.html#aca828d8168e3c247b8a551abaa14d1ce">free_gegraph</a></div><div class="ttdeci">static void free_gegraph(GEGraph *g)</div><div class="ttdef"><b>Definition:</b> general_graph.h:168</div></div>
<div class="ttc" id="list_8h_html_a58278c96876189b1431fb4ffab2e83fa"><div class="ttname"><a href="../../da/d23/list_8h.html#a58278c96876189b1431fb4ffab2e83fa">free_u8list</a></div><div class="ttdeci">static void free_u8list(u8list *list)</div><div class="ttdef"><b>Definition:</b> list.h:560</div></div>
<div class="ttc" id="list_8h_html_a9e7fca0dadad24a8e91c1daed8114546"><div class="ttname"><a href="../../da/d23/list_8h.html#a9e7fca0dadad24a8e91c1daed8114546">clear_u8list</a></div><div class="ttdeci">static void clear_u8list(u8list *list)</div><div class="ttdef"><b>Definition:</b> list.h:560</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_a2482354f5176a12970941152bef9bf54"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#a2482354f5176a12970941152bef9bf54">MCNS_TASK_OVERLAP</a></div><div class="ttdeci">#define MCNS_TASK_OVERLAP</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:29</div></div>
<div class="ttc" id="dagcns_8h_html_a15b4f699945f0b1de6ac0deb9b55d243"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a15b4f699945f0b1de6ac0deb9b55d243">free_bdplinkv</a></div><div class="ttdeci">static void free_bdplinkv(bdplinkv *list)</div><div class="ttdef"><b>Definition:</b> dagcns.h:54</div></div>
<div class="ttc" id="dagcns_8h_html_a7c104b73f7512123f6370409bf345b80"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a7c104b73f7512123f6370409bf345b80">branched_dynamic_programming_alignment</a></div><div class="ttdeci">static u4i branched_dynamic_programming_alignment(DAGCNS *g, u1i *query, int ql, GEGraph *geg, bdpnodev *bnodes, bdpedgev *bedges, u1v *mem_buffer)</div><div class="ttdef"><b>Definition:</b> dagcns.h:476</div></div>
<div class="ttc" id="dagcns_8h_html_a2304cc36c5ba97fd5e408ec86327d342"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a2304cc36c5ba97fd5e408ec86327d342">free_bdpnodev</a></div><div class="ttdeci">static void free_bdpnodev(bdpnodev *list)</div><div class="ttdef"><b>Definition:</b> dagcns.h:41</div></div>
<div class="ttc" id="chararray_8h_html_a44d90846173ac16facc9f4fa189f4e95"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#a44d90846173ac16facc9f4fa189f4e95">add_char_string</a></div><div class="ttdeci">static void add_char_string(String *str, char ch)</div><div class="ttdef"><b>Definition:</b> chararray.h:210</div></div>
<div class="ttc" id="kswx_8h_html_ac7402c48a08189d15a03d10517934092"><div class="ttname"><a href="../../d2/df4/kswx_8h.html#ac7402c48a08189d15a03d10517934092">kswx_overlap_align_core</a></div><div class="ttdeci">static void kswx_overlap_align_core(kswx_t *xs[2], u32list *cigars[2], int qlen, uint8_t *query, int tlen, uint8_t *target, int strand, int M, int X, int I, int D, int E, u8list *mem_cache)</div><div class="ttdef"><b>Definition:</b> kswx.h:112</div></div>
<div class="ttc" id="chararray_8h_html_a7eadcd55386fce9c8b49d41101d6529b"><div class="ttname"><a href="../../d0/d2a/chararray_8h.html#a7eadcd55386fce9c8b49d41101d6529b">clear_string</a></div><div class="ttdeci">static void clear_string(String *str)</div><div class="ttdef"><b>Definition:</b> chararray.h:242</div></div>
<div class="ttc" id="dbgcns_8h_html_a247df407c8dfb0eed8401fc7ea9bd782"><div class="ttname"><a href="../../d3/d39/dbgcns_8h.html#a247df407c8dfb0eed8401fc7ea9bd782">run_cns</a></div><div class="ttdeci">static int run_cns(CNS *cns, int candidate_mode, int corr_struct)</div><div class="ttdef"><b>Definition:</b> dbgcns.h:1313</div></div>
<div class="ttc" id="dagcns_8h_html_ad89107b73021e456c494bc1fd70aa992"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#ad89107b73021e456c494bc1fd70aa992">print_seq_dagcns</a></div><div class="ttdeci">static void print_seq_dagcns(DAGCNS *g, FILE *out)</div><div class="ttdef"><b>Definition:</b> dagcns.h:803</div></div>
<div class="ttc" id="mem__share_8h_html_a1a05ede2ad100bf5de5dfa7ccdfa4397"><div class="ttname"><a href="../../d5/d11/mem__share_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a></div><div class="ttdeci">return NULL</div><div class="ttdef"><b>Definition:</b> mem_share.h:678</div></div>
<div class="ttc" id="thread_8h_html_abe73a1c52172dec771ce6ee4ccae4b0e"><div class="ttname"><a href="../../db/dd5/thread_8h.html#abe73a1c52172dec771ce6ee4ccae4b0e">thread_end_func</a></div><div class="ttdeci">#define thread_end_func(tname)</div><div class="ttdef"><b>Definition:</b> thread.h:142</div></div>
<div class="ttc" id="list_8h_html_a4f4e8aa37ce212956c6c10f2388fbaad"><div class="ttname"><a href="../../da/d23/list_8h.html#a4f4e8aa37ce212956c6c10f2388fbaad">free_u1v</a></div><div class="ttdeci">static void free_u1v(u1v *list)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="dagcns_8h_html_a76b1d7e2b1eaf45e393bdf37a5392c1d"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a76b1d7e2b1eaf45e393bdf37a5392c1d">bdpgraph2dagcns</a></div><div class="ttdeci">static void bdpgraph2dagcns(DAGCNS *dg, GEGraph *gg, bdpnodev *bnodes, bdpedgev *bedges, u4i nbeg, bdplinkv *stack)</div><div class="ttdef"><b>Definition:</b> dagcns.h:553</div></div>
<div class="ttc" id="list_8h_html_a155857c4504786ebae8fb772a8e8f20a"><div class="ttname"><a href="../../da/d23/list_8h.html#a155857c4504786ebae8fb772a8e8f20a">append_u1v</a></div><div class="ttdeci">static void append_u1v(u1v *list1, u1v *list2)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_af93b0552c2b23f6fd2b5d2c0ccb5ff10"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#af93b0552c2b23f6fd2b5d2c0ccb5ff10">cns_debug</a></div><div class="ttdeci">static int cns_debug</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:25</div></div>
<div class="ttc" id="kswx_8h_html_a28770cc8ecc66842766ce4a9b6d9eaef"><div class="ttname"><a href="../../d2/df4/kswx_8h.html#a28770cc8ecc66842766ce4a9b6d9eaef">KSWX_NULL</a></div><div class="ttdeci">static const kswx_t KSWX_NULL</div><div class="ttdef"><b>Definition:</b> kswx.h:37</div></div>
<div class="ttc" id="dagcns_8h_html_a4c90e5d9e802a7158756843e9988f807"><div class="ttname"><a href="../../d0/d48/dagcns_8h.html#a4c90e5d9e802a7158756843e9988f807">free_dagcns</a></div><div class="ttdeci">static void free_dagcns(DAGCNS *g)</div><div class="ttdef"><b>Definition:</b> dagcns.h:121</div></div>
<div class="ttc" id="dna_8h_html_a905dc090c739b2a74eb5ad8a08d84100"><div class="ttname"><a href="../../d0/df5/dna_8h.html#a905dc090c739b2a74eb5ad8a08d84100">bit_base_table</a></div><div class="ttdeci">static const char bit_base_table[12]</div><div class="ttdef"><b>Definition:</b> dna.h:78</div></div>
<div class="ttc" id="wtdbg-cns_8c_html_a1523b96cc68bc9d33539aa387954b4ad"><div class="ttname"><a href="../../d3/d03/wtdbg-cns_8c.html#a1523b96cc68bc9d33539aa387954b4ad">MCNS_TASK_DAGCNS</a></div><div class="ttdeci">#define MCNS_TASK_DAGCNS</div><div class="ttdef"><b>Definition:</b> wtdbg-cns.c:28</div></div>
<div class="ttc" id="list_8h_html_a0393398de16907e0362767fd47746653"><div class="ttname"><a href="../../da/d23/list_8h.html#a0393398de16907e0362767fd47746653">clear_u1v</a></div><div class="ttdeci">static void clear_u1v(u1v *list)</div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
<div class="ttc" id="structu1v_html"><div class="ttname"><a href="../../d6/d1f/structu1v.html">u1v</a></div><div class="ttdef"><b>Definition:</b> list.h:561</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad876cdd1a72412cf2e0d2fcde266dd9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad876cdd1a72412cf2e0d2fcde266dd9a">&#9670;&nbsp;</a></span>usage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;           {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    printf(</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="stringliteral">&quot;WTDBG-CNS: Consensuser for wtdbg\n&quot;</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="stringliteral">&quot;Author: Jue Ruan &lt;ruanjue@gmail.com&gt;\n&quot;</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="stringliteral">&quot;Version: 1.1\n&quot;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="stringliteral">&quot;Usage: wtdbg-cns [options]\n&quot;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="stringliteral">&quot;Options:\n&quot;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="stringliteral">&quot; -t &lt;int&gt;    Number of threads, [1]\n&quot;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="stringliteral">&quot; -i &lt;string&gt; Input file(s) *.utg.cns from wtdbg, +, [STDIN]\n&quot;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="stringliteral">&quot; -o &lt;string&gt; Output files, [STDOUT]\n&quot;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="stringliteral">&quot; -f          Force overwrite\n&quot;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="stringliteral">&quot; -j &lt;int&gt;    Expected length of node, or say the overlap length of two adject units in layout file, [1000] bp\n&quot;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="stringliteral">&quot;-----------------BEG DBG options---------------------------------\n&quot;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="stringliteral">&quot; -k &lt;int&gt;    Kmer size for long reads, [15]\n&quot;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="stringliteral">&quot; -Z &lt;int&gt;    Z-cutoff, drop the lower  (score / &lt;-X&gt;), [4]\n&quot;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="stringliteral">&quot; -W &lt;int&gt;    W-cutoff, drop the lagger (position), [48]\n&quot;</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="stringliteral">&quot;             In DAG correction, -W set the bandwidth of alignment\n&quot;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="stringliteral">&quot; -H &lt;int&gt;    High coverage bonus, [1]\n&quot;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="stringliteral">&quot; -L &lt;int&gt;    High coverage cutoff = avg_cov / &lt;-L&gt; [10]\n&quot;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="stringliteral">&quot; -c &lt;int&gt;    Candidate strategy, 0: best-kmers, 1: median length, 2: first (include), 3: first (exclude), 4: longest, 5, shortest, [0]\n&quot;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="stringliteral">&quot;             In DAG correction, force to use strategy 2\n&quot;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="stringliteral">&quot;-----------------END DBG options---------------------------------\n&quot;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="stringliteral">&quot; -M &lt;int&gt;    Match score, [2]\n&quot;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="stringliteral">&quot; -X &lt;int&gt;    Mismatch score, [-7]\n&quot;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="stringliteral">&quot; -I &lt;int&gt;    Insertion score, [-3]\n&quot;</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="stringliteral">&quot; -D &lt;int&gt;    Deletion score, [-4]\n&quot;</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="stringliteral">&quot; -E &lt;int&gt;    Gap extension score, [-2]\n&quot;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="stringliteral">&quot; -m &lt;int&gt;    1: DBG correction; 2: DAG correction, [1]\n&quot;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="stringliteral">&quot; -S &lt;int&gt;    whether to correct structure before error correction, [1]\n&quot;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="stringliteral">&quot; -v          Verbose\n&quot;</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="stringliteral">&quot; -V          Print version information and then exit\n&quot;</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af93b0552c2b23f6fd2b5d2c0ccb5ff10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93b0552c2b23f6fd2b5d2c0ccb5ff10">&#9670;&nbsp;</a></span>cns_debug</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int cns_debug = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d3/d03/wtdbg-cns_8c.html">wtdbg-cns.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
